{"id":"daemon-001","title":"Replication daemon MVP","description":"MVP replication daemon that taps kilo serve SSE event stream via @opencode-ai/sdk, classifies session events, mints punches, and writes to Dolt. Sidecar to kilo serve. Working name: oc-daemon (opencode daemon).","notes":"Scaffolded: ~/Projects-Employee-1/oc-daemon/ — TypeScript skeleton with src/{classifier,writer,lifecycle}, package.json, tsconfig.json. SDK v1.2.9 has packaging issue (exports miss dist/src/ path).","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-21T02:41:36Z","created_by":"galeavenworth-personal","updated_at":"2026-02-21T02:58:09Z","closed_at":"2026-02-21T02:58:09Z","close_reason":"Closed","dependencies":[{"issue_id":"daemon-001","depends_on_id":"repomap-core-4f0.15","type":"relates-to","created_at":"2026-02-21T07:22:14Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-0os","title":"Phase 3: Workflow documentation consolidation","description":"Consolidate all workflow documentation to reflect specialized orchestrator modes (§3 Phase 3).\n\n## Deliverables\n\n1. Verify all orchestrate-*.md files are annotated as reference docs (from Phase 1 + Phase 2 work)\n2. Update capabilities.md registry:\n   - Add process-orchestrator and audit-orchestrator to Orchestrator Workflows section\n   - Add whenToUse guidance for each\n   - Update activation patterns\n3. Update tasks.md with new invocation patterns:\n   - Replace /orchestrate-start-task + /orchestrate-execute-task references with process-orchestrator invocation\n   - Replace /orchestrate-pressure-test reference with audit-orchestrator invocation\n4. Add deprecation markers on generic-Orchestrator-based workflow invocations\n\n## Files Affected\n\n- .kilocode/rules/memory-bank/capabilities.md\n- .kilocode/rules/memory-bank/tasks.md\n- All .kilocode/workflows/orchestrate-*.md files (verify annotations)\n\n## Acceptance Criteria\n\n- capabilities.md accurately reflects new mode landscape\n- tasks.md shows current invocation patterns\n- No stale references to old /orchestrate-* workflow invocations without deprecation markers\n- Operator can unambiguously determine which orchestrator to use from capabilities.md\n\n## References\n\n- Plan: plans/specialized-orchestrator-modes.md §3 Phase 3, §7\n- Depends on: repomap-core-2b9 (Phase 1 doc downgrade), repomap-core-qvz (Phase 2 doc annotation)","spec_id":"plans/specialized-orchestrator-modes.md","status":"closed","priority":2,"issue_type":"chore","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-14T19:44:18Z","created_by":"galeavenworth-personal","updated_at":"2026-02-15T22:06:54Z","closed_at":"2026-02-15T22:06:54Z","close_reason":"Closed"}
{"id":"repomap-core-13v","title":"Stream D: File Kilo-specific issue referencing OpenCode #6489","description":"File a Kilo-specific issue or comment on OpenCode #6489 documenting our --attach regression findings and the SDK prompt API workaround. Manual task (no code). External ref: opencode-6489. Parent decision: repomap-core-w1a.","status":"open","priority":3,"issue_type":"chore","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-22T13:29:46Z","created_by":"galeavenworth-personal","updated_at":"2026-02-22T13:29:46Z","external_ref":"opencode-6489","labels":["sdk-pivot","upstream"],"dependencies":[{"issue_id":"repomap-core-13v","depends_on_id":"repomap-core-w1a","type":"discovered-from","created_at":"2026-02-22T08:29:46Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-1jj","title":"Phase C: Create /factory-health-check workflow","description":"Create the orchestrated /factory-health-check workflow combining Layers 1-3 of observability (§10 Phase C).\n\n## Workflow Steps\n\n1. Run receipt_audit.py for recent bead IDs (Layer 1 — deterministic)\n2. Spawn Factory Inspector subtask with audit reports as input (Layer 2 — interpretive)\n3. Inspector analyzes patterns and produces health report (Layer 2)\n4. Present compiled health report and recommendations (Layer 3)\n\n## Trigger Options\n\n- Manual: /factory-health-check (operator-initiated)\n- Post-workflow: Run as final step of /orchestrate-execute-task (self-audit)\n- Periodic: After every N completed tasks\n\n## Parent Orchestrator\n\nCan be invoked by Process Orchestrator (if Phase 1 complete) or generic Orchestrator.\n\n## Deliverables\n\n1. Workflow document: .kilocode/workflows/factory-health-check.md\n2. Integration instructions for orchestrators\n3. Example invocation and expected output format\n\n## Acceptance Criteria\n\n- Workflow produces a health report from real workflow receipts\n- Combines deterministic audit (receipt_audit.py) with interpretive analysis (Factory Inspector)\n- Report includes actionable recommendations\n\n## References\n\n- Plan: plans/specialized-orchestrator-modes.md §10, Phase C\n- Depends on: repomap-core-9o8 (Factory Inspector mode), repomap-core-9uq (Process Orchestrator — soft dep)","spec_id":"plans/specialized-orchestrator-modes.md","status":"closed","priority":3,"issue_type":"feature","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-14T19:45:05Z","created_by":"galeavenworth-personal","updated_at":"2026-02-18T00:28:36Z","closed_at":"2026-02-18T00:28:36Z","close_reason":"SIMPLIFIED by roadmap v2: Replaced by hlth.1 (plant health composite command). Single composite command reading session data instead of multi-phase workflow. See plans/roadmap-plant-infrastructure.md"}
{"id":"repomap-core-1nb","title":"Specialized orchestrator modes — replace document-driven orchestration with purpose-built modes","description":"Replace the current generic orchestrator + workflow markdown architecture with specialized orchestrator modes (process-orchestrator, audit-orchestrator) that have built-in tool routing, lifecycle management, and handoff packet contracts. This is the critical path fix for systematic line faults caused by subtasks failing to use required tools.","status":"closed","priority":1,"issue_type":"epic","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-15T16:20:33Z","created_by":"galeavenworth-personal","updated_at":"2026-02-15T22:07:04Z","closed_at":"2026-02-15T22:07:04Z","close_reason":"Closed"}
{"id":"repomap-core-1tg","title":"Orchestration research — token economics, interaction patterns, and workflow-as-code","description":"Cross-cutting research tasks that inform specialized orchestrator design: token budget analysis, mode interaction heuristics (switch_mode vs new_task), Fitter contract verification, and long-horizon workflow-as-code feasibility.","status":"closed","priority":2,"issue_type":"epic","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-15T16:20:34Z","created_by":"galeavenworth-personal","updated_at":"2026-02-18T00:28:44Z","closed_at":"2026-02-18T00:28:44Z","close_reason":"COMPLETE: All children closed (c6j, wt5, 3wo). Orchestration research concluded — findings absorbed into roadmap v2 pivot."}
{"id":"repomap-core-2b9","title":"Phase 1: Downgrade orchestrate-start/execute-task.md to reference documentation","description":"Convert the orchestrate-start-task.md and orchestrate-execute-task.md workflow files from runtime templates to reference documentation (§3 Phase 1 deliverable 4).\n\n## Changes Required\n\nFor each file:\n1. Add header notice: 'This document is reference documentation. The Process Orchestrator mode embeds this logic natively.'\n2. Mark sections that are now handled by the Process Orchestrator roleDefinition\n3. Keep the documents as reference for understanding the logic, but they are no longer read at runtime by the orchestrator\n\n## Files Affected\n\n- .kilocode/workflows/orchestrate-start-task.md (527 lines)\n- .kilocode/workflows/orchestrate-execute-task.md (876 lines)\n\n## Acceptance Criteria\n\n- Both files have reference-doc header annotation\n- Process Orchestrator mode does NOT load these files\n- Documents remain accurate as reference material\n\n## References\n\n- Plan: plans/specialized-orchestrator-modes.md §3 Phase 1\n- Depends on: repomap-core-9uq (mode must exist before downgrading docs)","spec_id":"plans/specialized-orchestrator-modes.md","status":"closed","priority":2,"issue_type":"chore","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-14T19:43:46Z","created_by":"galeavenworth-personal","updated_at":"2026-02-15T20:41:22Z","closed_at":"2026-02-15T20:41:22Z","close_reason":"Closed"}
{"id":"repomap-core-2q1","title":"Stream C: Create native opencode.json agent definitions","description":"Optional config hygiene: create a native opencode.json file in repomap-core alongside .kilocodemodes. This supplements the auto-migrated agent definitions with native OpenCode format. No product code impact. Target repo: repomap-core. Parent decision: repomap-core-w1a.","status":"open","priority":3,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-22T13:29:38Z","created_by":"galeavenworth-personal","updated_at":"2026-02-22T13:29:38Z","labels":["config","repo:repomap-core","sdk-pivot"],"dependencies":[{"issue_id":"repomap-core-2q1","depends_on_id":"repomap-core-w1a","type":"discovered-from","created_at":"2026-02-22T08:29:38Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-35t","title":"Phase 3 — Artifact Query API","description":"Port the deterministic, typed artifact query API into repomap-core so agents can query .repomap/ artifacts programmatically. This includes ArtifactStore (normalized collections), QueryEngine (typed filter AST), QueryService facade, and optional CLI subcommand.\n\nReferences:\n- Implementation guide: plans/repomap-core-query-bundle/IMPLEMENTATION_GUIDE.md (authoritative)\n- Roadmap: plans/ROADMAP.md (Phase 3)\n- Staging source: plans/repomap-core-query-bundle/staging/\n\nDefinition of Done:\n- All 5 child tasks completed and closed\n- src/query/ package exists with ArtifactStore, QueryEngine, QueryService\n- Agents can execute structured queries against .repomap/ artifacts\n- All quality gates pass (ruff format, ruff check, mypy, pytest)\n","status":"open","priority":1,"issue_type":"epic","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:32:59Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:46:56Z"}
{"id":"repomap-core-35t.1","title":"Port ArtifactStore into src/query/","description":"Copy and adapt the ArtifactStore from the staging query bundle into repomap-core. Provides normalized collection access to .repomap/ artifacts with receipts (matched locations). Replace hard-coded filenames with contract constants.\n\nKey methods: get_collection(), get_record_location(), list_collections(), artifacts_hash\n\nReferences:\n- Source to port: plans/repomap-core-query-bundle/staging/repomap_claims/artifact_store.py\n- Legacy reference: plans/repomap-core-query-bundle/legacy/repomap_claims/artifact_store.py\n- Contract constants: src/contract/artifacts.py (TIER1_ARTIFACT_SPECS)\n- Guide: plans/repomap-core-query-bundle/IMPLEMENTATION_GUIDE.md (Step 1)\n\nDefinition of Done:\n- src/query/artifact_store.py exists\n- ArtifactStore loads all Tier-1 artifacts as normalized collections\n- Uses contract constants for artifact filenames\n- get_collection(), get_record_location(), list_collections() work\n- artifacts_hash produces deterministic hash\n- No imports from repomap_claims\n- Quality gates pass\n","status":"open","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:34:19Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:47:02Z"}
{"id":"repomap-core-35t.2","title":"Port QueryEngine + StructuredQuery","description":"Copy and adapt the typed filter AST and query executor from the staging query bundle. Includes Pydantic models: FieldFilter, AndFilter, OrFilter, ExistsAssertion, CountAssertion, StructuredQuery, QueryResult.\n\nReferences:\n- Source to port: plans/repomap-core-query-bundle/staging/repomap_claims/query_engine.py\n- Legacy reference: plans/repomap-core-query-bundle/legacy/repomap_claims/query_engine.py\n- Guide: plans/repomap-core-query-bundle/IMPLEMENTATION_GUIDE.md (Step 2)\n\nDefinition of Done:\n- src/query/query_engine.py exists\n- All Pydantic models ported: FieldFilter, AndFilter, OrFilter, ExistsAssertion, CountAssertion, StructuredQuery, QueryResult\n- QueryEngine.execute() processes queries against ArtifactStore collections\n- Query validation (valid/invalid queries handled gracefully)\n- No imports from repomap_claims\n- Quality gates pass\n","status":"open","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:34:23Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:47:07Z"}
{"id":"repomap-core-35t.3","title":"Add QueryService facade","description":"Create a thin agent-friendly wrapper that combines ArtifactStore and QueryEngine into a simple API. Supports dict-based query input (auto-parsed via model_validate), plus convenience methods exists() and count().\n\nReferences:\n- Guide: plans/repomap-core-query-bundle/IMPLEMENTATION_GUIDE.md (Step 3)\n\nDefinition of Done:\n- src/query/service.py exists with QueryService class\n- QueryService.__init__(artifacts_dir) sets up store + engine\n- execute(query) accepts StructuredQuery or dict, returns QueryResult\n- exists(collection, filter_dict) returns bool\n- count(collection, filter_dict) returns int\n- src/query/__init__.py re-exports public API\n- Quality gates pass\n","status":"open","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:34:31Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:47:12Z"}
{"id":"repomap-core-35t.4","title":"Query API tests — round-trip, edge cases, determinism","description":"Test the query API with round-trip queries on fixture artifacts, edge cases (missing artifacts, invalid queries), and determinism verification.\n\nReferences:\n- Guide: plans/repomap-core-query-bundle/IMPLEMENTATION_GUIDE.md (Suggested Tests)\n\nDefinition of Done:\n- Test fixtures with valid .repomap/ artifacts\n- Round-trip test: build query → execute → verify matches + receipts\n- Edge case: missing artifacts return empty collections, don't crash\n- Edge case: invalid queries return query_valid=False or raise validation error\n- Determinism: same query + artifacts → same results\n- Quality gates pass\n","status":"open","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:34:35Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:47:17Z"}
{"id":"repomap-core-35t.5","title":"(Optional) CLI query subcommand","description":"Add 'repomap query' subcommand to the CLI. Minimal interface: reads a query from a JSON file and returns matches + matched_locations as JSON output.\n\nUsage: repomap query --artifacts-dir .repomap --query-file query.json\n\nReferences:\n- Guide: plans/repomap-core-query-bundle/IMPLEMENTATION_GUIDE.md (Step 4)\n- Source: src/cli.py (_build_parser)\n\nDefinition of Done:\n- CLI accepts 'query' subcommand\n- Reads query from --query-file (JSON)\n- Returns JSON output with matches + matched_locations\n- Error handling for missing files, invalid JSON, invalid queries\n- Quality gates pass\n","status":"open","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:34:39Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:47:21Z"}
{"id":"repomap-core-3k9","title":"Phase 4 — Change Slice Foundation","description":"Implement the deterministic foundation for change slices — graph-derived contracts that define the structural boundary of a planned code change. This is repomap-core's contribution to Layer 4 of the whitepaper architecture.\n\nReferences:\n- Roadmap: plans/ROADMAP.md (Phase 4)\n- Whitepaper: plans/proposed_architecture_whitepaper.md (Layer 4: Change Slices as Contracts)\n- Architecture review: plans/whitepaper_architecture_review.md (Layer 4 gap analysis)\n\nDefinition of Done:\n- All 5 child tasks completed and closed\n- N-hop neighborhood extraction works on dependency + call graphs\n- Slice artifact format specified and generated\n- Contract extended with slice artifact specs\n- All quality gates pass\n","status":"open","priority":1,"issue_type":"epic","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:33:02Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:47:26Z"}
{"id":"repomap-core-3k9.1","title":"N-hop neighborhood extraction from dependency + call graphs","description":"Given a symbol or module, extract the inbound/outbound neighborhood to depth N from deps.edgelist and calls.jsonl. This is the core graph algorithm that powers change slices.\n\nShould support both module-level (from deps.edgelist) and symbol-level (from calls.jsonl) extraction.\n\nReferences:\n- Whitepaper: plans/proposed_architecture_whitepaper.md (Layer 4)\n- Architecture review: plans/whitepaper_architecture_review.md (Change Slices section)\n- Existing graph code: src/graph/algos.py (build_dependency_graph, find_cycles)\n\nDefinition of Done:\n- Function extracts N-hop inbound callers from a given symbol/module\n- Function extracts N-hop outbound callees from a given symbol/module\n- Works with both deps.edgelist (module-level) and calls.jsonl (symbol-level)\n- Returns structured graph neighborhood (nodes + edges)\n- Deterministic output for given inputs\n- Quality gates pass\n","status":"open","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:34:43Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:47:31Z"}
{"id":"repomap-core-3k9.2","title":"Slice artifact format specification","description":"Design and specify the slice artifact format. A slice defines: the target symbol, inbound callers within N hops, outbound callees within N hops, dependency neighborhood, and resolution tier coverage metrics for the region.\n\nReferences:\n- Whitepaper: plans/proposed_architecture_whitepaper.md (Layer 4)\n- Architecture review: plans/whitepaper_architecture_review.md (Layer 4)\n- Pattern: src/contract/artifacts.py (Tier1ArtifactSpec for format)\n\nDefinition of Done:\n- Pydantic model for SliceRecord defined\n- Format supports: target symbol, inbound/outbound neighborhoods, edge metadata\n- Resolution coverage metrics per node (resolution tier distribution)\n- Schema version included\n- Format documented\n- Quality gates pass\n","status":"open","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:34:47Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:47:37Z"}
{"id":"repomap-core-3k9.3","title":"Slice generation from graph data","description":"Implement the generator that produces change slice artifacts from the dependency graph and call graph data. Combines N-hop extraction with artifact formatting.\n\nReferences:\n- Depends on: repomap-core-3k9.1 (N-hop extraction) and repomap-core-3k9.2 (format spec)\n- Pattern: src/artifacts/generators/ (existing generator pattern)\n\nDefinition of Done:\n- SliceGenerator produces slice artifacts given a target symbol and depth N\n- Consumes deps.edgelist and calls.jsonl as inputs\n- Output is deterministic\n- Integrates with generate_all_artifacts() or standalone invocation\n- Quality gates pass\n","status":"open","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:34:51Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:47:42Z"}
{"id":"repomap-core-3k9.4","title":"Contract extension for slice artifacts","description":"Extend the contract surface to include slice artifact specs. Add validation rules for slice schema.\n\nReferences:\n- Source: src/contract/artifacts.py\n- Source: src/contract/validation.py\n- Source: src/contract/models.py\n\nDefinition of Done:\n- Slice artifact constants added to contract\n- SliceRecord model exposed via contract surface\n- Validation rules for slice artifact format\n- Quality gates pass\n","status":"open","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:34:55Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:47:48Z"}
{"id":"repomap-core-3k9.5","title":"Post-change recomputation support (diff detection)","description":"Support re-running artifact generation after code changes and detecting structural drift. Enable comparison of before/after slices to flag unintended structural changes.\n\nReferences:\n- Whitepaper: plans/proposed_architecture_whitepaper.md (Layer 4 — 'Post-change graph recomputation must not introduce unintended structural drift')\n- Source: src/verify/verify.py (verify_determinism — existing diff pattern)\n\nDefinition of Done:\n- Artifacts can be regenerated and diffed against previous versions\n- Structural drift detection: new/removed edges, changed resolution tiers\n- Report format for drift summary\n- Quality gates pass\n","status":"open","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:34:59Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:47:52Z"}
{"id":"repomap-core-3wn","title":"Factory observability — deterministic receipt auditing and workflow health inspection","description":"Add deterministic introspection to the factory-line architecture: receipt manifests, audit tooling, factory-inspector mode, health-check workflows, and self-audit integration. Enables proactive detection of line faults like tool-skipping before they cascade.","status":"closed","priority":2,"issue_type":"epic","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-15T16:20:33Z","created_by":"galeavenworth-personal","updated_at":"2026-02-18T00:28:44Z","closed_at":"2026-02-18T00:28:44Z","close_reason":"COMPLETE: All children closed/absorbed by roadmap v2 pivot. Factory observability now handled by session data + kilo_session_monitor.py. New work tracked under Phase 2-4 beads."}
{"id":"repomap-core-3wo","title":"Orchestrator composability patterns — handoff contracts and return parsing","description":"PIVOTED from 'Workflow-as-code feasibility — MCP workflow engine' on 2026-02-15.\n\nNative new_task composability (proven in nested-new-task-experiment-2026-02-15) supersedes the MCP workflow engine concept. The orchestrator's message parameter is the program, the todos parameter is the structured input, and attempt_completion is the return value.\n\n## Revised Scope\n\n1. Define handoff packet schemas for orchestrator→orchestrator delegation\n2. Define return format conventions (parseable markdown with known headers, or fenced JSON blocks)\n3. Document nesting depth budget policies (recommended max 3 levels)\n4. Establish error/failure propagation patterns across nesting levels\n5. Document the validated mode interaction heuristic (new_task vs switch_mode)\n\n## Evidence\n\n- Experiment: docs/research/nested-new-task-experiment-2026-02-15.md\n- Analysis: docs/research/orchestrator-composability-analysis-2026-02-15.md\n\n## Acceptance Criteria\n\n- Handoff packet schema documented and tested in at least one composability scenario\n- Return format convention documented with parsing examples\n- Nesting depth budget policy documented with cost rationale\n- Mode interaction heuristic table validated against experiment findings","spec_id":"plans/specialized-orchestrator-modes.md","status":"closed","priority":3,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-14T19:42:52Z","created_by":"galeavenworth-personal","updated_at":"2026-02-16T19:06:16Z","closed_at":"2026-02-16T19:06:16Z","close_reason":"Closed"}
{"id":"repomap-core-4f0","title":"Plant Manager — strategic orchestrator for workflow system ownership","description":"Plant Manager — strategic orchestrator for workflow system ownership.\n\nUPDATED 2026-02-17: Roadmap v2 pivot. Factory Inspector mode CUT (Plant Manager reads session data directly). Receipt infrastructure ABSORBED (kilo_session_monitor.py IS the receipt tool). Feedback loops SIMPLIFIED (command -\u003e spawn -\u003e monitor -\u003e verify).\n\n## Active Children (Post-Pivot)\n- 4f0.5: Fitter dispatch via command dialect (Phase 3)\n\n## Completed Children\n- 4f0.1: Plant Manager mode definition (DONE)\n- 4f0.2: Workflow-specific gates (DONE)\n- 4f0.3: Composability handoff contracts (DONE)\n\n## Cut Children\n- 4f0.4: Factory-inspector integration (CUT — no Inspector mode needed)\n\n## Architecture (Post-Pivot)\nCommand Dialect -\u003e Spawn Subtask -\u003e Session Monitor -\u003e Verify -\u003e Commit State\n\n## References\n- Roadmap: plans/roadmap-plant-infrastructure.md\n- Session data discovery: docs/research/kilo-session-data-as-receipts.md\n- Self-monitoring: docs/research/kilo-session-realtime-self-monitoring.md","status":"open","priority":2,"issue_type":"epic","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-16T00:07:05Z","created_by":"galeavenworth-personal","updated_at":"2026-02-18T00:29:17Z"}
{"id":"repomap-core-4f0.1","title":"Plant Manager mode definition in .kilocodemodes","description":"Define the plant-manager mode in .kilocodemodes.\n\n## Mode Specification\n\n- Slug: plant-manager\n- Model: anthropic/claude-opus-4.6 (strategic reasoning)\n- Tool groups: read, edit, command, mcp (all MCP servers)\n- File regex: covers .kilocode/, .kilocodemodes, AGENTS.md, docs/research/\n\n## roleDefinition Scope\n\nStrategic orchestrator for the fabrication plant:\n- Owns workflow system artifacts (modes, skills, contracts, fit profiles, gate configs)\n- Spawns tactical orchestrators (process-orchestrator, audit-orchestrator) via new_task\n- Spawns factory-inspector for health assessment\n- Dispatches fitter for workflow-system repairs\n- Validates changes via workflow-specific gates\n- Does NOT directly edit src/ code — delegates to process-orchestrator\n\n## customInstructions\n\n- Three-tier composability pattern (strategic → tactical → specialist)\n- Max nesting depth: 3 levels\n- Handoff packet format for tactical orchestrator delegation\n- Workflow-specific gate checklist (mode validation, skill loading, contract parsing)\n- Fitter dispatch patterns (absorbed from repomap-core-c6j)\n\n## Acceptance Criteria\n\n- Mode definition validates in .kilocodemodes (YAML syntax correct)\n- Mode can be selected and invoked\n- roleDefinition clearly scopes plant ownership vs product development\n- customInstructions include composability patterns\n\n## References\n\n- Analysis: docs/research/orchestrator-composability-analysis-2026-02-15.md","status":"closed","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-16T00:07:17Z","created_by":"galeavenworth-personal","updated_at":"2026-02-17T02:43:25Z","closed_at":"2026-02-17T02:43:25Z","close_reason":"Closed"}
{"id":"repomap-core-4f0.10","title":"Cost budget enforcement via session monitor","description":"UPDATED 2026-02-23: Now grounded in real cost data from Experiment A/B.\n\nCost budget enforcement — governor-integrated, Dolt-backed.\n\n## Real Cost Data (Experiment A/B, 2026-02-23)\n- First 100k tokens: $0.29-0.42 (cheap zone)\n- Tokens 100k-200k in same session: $0.64 (2.2x)\n- Tokens 200k-300k: $0.83 (2.9x)\n- Tokens 300k-400k: $1.22 (4.2x)\n- One runaway session (267 steps): $5.94 = 67% of total experiment cost\n- Well-behaved decomposed sessions: $0.42/100k tokens (42% cheaper than monolithic)\n\n## Updated Scope\n1. Governor queries Dolt punch card in real-time for cost accumulation per session\n2. Configurable thresholds:\n   - Per-session cost cap (default: $1.00 — covers ~200k tokens in cheap zone)\n   - Per-session step cap (default: 50 steps — well above typical 6-35 range)\n   - Per-subtask-tree cost cap (aggregate across parent + children)\n3. On threshold breach: trigger governor loop detection (repomap-core-7xo)\n4. Cost data already flows: daemon writes cost/tokens to punches table via step-finish events\n\n## Depends On\n- repomap-core-7xo (governor epic)\n- repomap-core-hlr (monorepo migration)\n- Daemon punch writing (DONE — cost columns in punches table)\n\n## Acceptance Criteria\n- Cost queries work against live Dolt data\n- Thresholds are configurable (not hardcoded)\n- Breach triggers governor response (not just alert)\n- Works across subtask tree (parent + children aggregate)\n\n## References\n- oc-daemon/docs/analysis/experiment-ab-comparison.md (cost curves, token buckets)","status":"open","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-18T00:30:41Z","created_by":"galeavenworth-personal","updated_at":"2026-02-23T14:54:33Z"}
{"id":"repomap-core-4f0.11","title":"Command-triggered subtask verification loop","description":"UPDATED 2026-02-23: Reframed as punch-card-verified completion with governor enforcement.\n\n## Updated Scope\nThe full verification loop, grounded in experiment data:\n\n1. Parent spawns subtask via session.prompt() (bounded goal, ≤100k tokens)\n2. Daemon records punches in real-time (tool calls, steps, cost, tokens)\n3. Governor monitors punch card against thresholds (repomap-core-4f0.10)\n4. On completion: punch card validation\n   - Required punches present (e.g. quality gate pass, commit)\n   - No anomalies (excessive steps, cost overrun, repeated patterns)\n   - Tool adherence check (edit count within expected range — cornerstone #1)\n5. On validation pass: task marked complete\n6. On validation fail or governor intervention: line fitter dispatched (repomap-core-4f0.5)\n\n## Tool Adherence — Cornerstone #1\nExperiment A/B showed both monolithic and decomposed approaches made exactly 44 edit calls. Tool adherence is invariant to session architecture. This is the first enforceable metric:\n- Expected edit count can be estimated from task scope\n- Deviation from expected range triggers review\n- Punch card already records every tool call\n\n## Depends On\n- repomap-core-7xo (governor epic)\n- repomap-core-4f0.10 (cost budget thresholds)\n- repomap-core-4f0.5 (fitter dispatch on failure)\n- repomap-core-hlr (monorepo migration)\n\n## Acceptance Criteria\n- No task can complete without a valid punch card\n- No parent can complete without valid child punch cards\n- Governor can intervene mid-session on threshold breach\n- Tool adherence is tracked and enforceable\n- All verification queries durable Dolt-backed state\n\n## References\n- oc-daemon/docs/analysis/experiment-ab-comparison.md (tool usage comparison)\n- plans/roadmap-plant-infrastructure.md Phase 3","status":"closed","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-18T00:30:48Z","created_by":"galeavenworth-personal","updated_at":"2026-02-26T03:06:25Z","closed_at":"2026-02-26T03:06:25Z","close_reason":"Closed"}
{"id":"repomap-core-4f0.12","title":"Post-workflow session audit","description":"UPDATED 2026-02-23: Now grounded in real experiment data and governor architecture.\n\nPost-workflow session audit — automated anomaly detection from Dolt punch data.\n\n## Updated Scope\nAfter any workflow run, automatically query Dolt punch data and flag anomalies:\n1. Missing quality gate punches (no typecheck/lint/test/build recorded)\n2. Cost anomalies (session exceeded cheap zone threshold)\n3. Loop signatures (repeated tool patterns, step count spikes)\n4. Tool adherence deviation (edit count outside expected range for task type)\n5. Incomplete subtask trees (parent completed but children missing/failed)\n6. Stall detection (long gaps between punches)\n\n## Data Available (already flowing)\n- Punch card: task_id, punch_type, punch_key, observed_at, source_hash, cost, tokens_input, tokens_output, tokens_reasoning\n- Child relations: parent_id, child_id\n- All recorded by daemon in real-time\n\n## Depends On\n- repomap-core-hlr (monorepo migration)\n- repomap-core-7xo (governor — audit is the post-hoc version of governor's real-time detection)\n\n## References\n- oc-daemon/docs/analysis/experiment-ab-comparison.md (what anomalies look like in real data)","status":"open","priority":3,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-18T00:30:55Z","created_by":"galeavenworth-personal","updated_at":"2026-02-23T14:55:00Z"}
{"id":"repomap-core-4f0.13","title":"Plant health composite command","description":"UPDATED 2026-02-23: Now includes governor health and experiment-derived metrics.\n\nPlant health composite command — single command returning structured health report.\n\n## Updated Scope\n'Inspect plant-health' reads:\n1. Punch card status per active session (step count, cost, tool adherence)\n2. Governor status (any sessions under intervention, any active line fitters)\n3. Quality gate results (last pass/fail per project)\n4. Cost summary (total spend, per-session breakdown, cheap zone vs ballooned)\n5. Subtask tree health (parent-child completeness, orphaned sessions)\n6. Daemon health (connected to kilo serve, Dolt write latency)\n\n## Key Metrics (from Experiment A/B)\n- Cost per 100k tokens (target: ≤$0.42 in cheap zone)\n- Tool adherence ratio (edits vs overhead tools)\n- Session step count (target: ≤50 for bounded tasks)\n- Loop detection score (repeated tool pattern frequency)\n\n## Depends On\n- repomap-core-hlr (monorepo migration)\n- repomap-core-7xo (governor status)\n- repomap-core-4f0.10 (cost budget data)\n\n## References\n- oc-daemon/docs/analysis/experiment-ab-comparison.md","status":"open","priority":3,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-18T00:31:03Z","created_by":"galeavenworth-personal","updated_at":"2026-02-23T14:55:11Z"}
{"id":"repomap-core-4f0.14","title":"Dolt schema initialization (split from original 4f0.14 per roadmap v3.1)","description":"Plant-manager currently has no employees. All plant work (modes, skills, contracts, tools under .kilocode/) runs inline in a single context, causing context bloat past 75k tokens.\n\nNeeded:\n1. plant-orchestrator (Tier 2) — tactical orchestrator below plant-manager, parallel to process-orchestrator. Routes plant work through discover/design/implement/gate lifecycle, delegating to fitter, plant-architect, and docs-specialist.\n\n2. plant-architect (Tier 3) — designs mode definitions, skill interfaces, contract schemas, workflow structures. Separate from fitter who implements/repairs.\n\n3. Fitter refinement — clarify .kilocode/** file restrictions and wire plant gate contract (workflow_gate.py instead of ruff/mypy/pytest).\n\n4. docs-specialist — add plant-aware file patterns alongside existing .md restriction.\n\nCost context: model output quality degrades rapidly past 75k tokens. 50k is ideal, 75-100k acceptable, 100k+ red flag, 150k+ disaster. Each orchestration phase (discover, explore, plan, implement, gate) should be its own subtask to stay in the golden 50k zone.\n\nThis is the highest-priority plant infrastructure ticket because every future plant task pays the bloat tax until delegation works.","notes":"Roadmap v3.1 split: original 4f0.14 (plant staffing) → 4f0.14a (schema, repomap-core) + daemon-001 (daemon, own repo). This bead covers the schema/Dolt-init portion only.","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-18T13:44:12Z","created_by":"galeavenworth-personal","updated_at":"2026-02-19T12:48:55Z","closed_at":"2026-02-19T12:48:55Z","close_reason":"Closed"}
{"id":"repomap-core-4f0.15","title":"Punch engine implementation","description":"Minting rules, card evaluation, DOLT_COMMIT on gate pass. See plans/punch-card-schema.sql for DDL.","status":"closed","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-19T00:13:07Z","created_by":"galeavenworth-personal","updated_at":"2026-02-21T14:25:15Z","closed_at":"2026-02-21T14:25:15Z","close_reason":"Closed","dependencies":[{"issue_id":"repomap-core-4f0.15","depends_on_id":"daemon-001","type":"relates-to","created_at":"2026-02-21T07:22:13Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-4f0.16","title":"Dependency freshness — install Dolt + bump version floors","description":"Install Dolt binary. Bump all pyproject.toml version floors per dependency tier model (see plans/plant-sprint-plan.md). Run quality gates to verify compatibility. Tier 1: ruff, dolt. Tier 2: pydantic, tree-sitter, mypy, pytest. Tier 3: orjson, gitignore-parser.","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-19T00:13:15Z","created_by":"galeavenworth-personal","updated_at":"2026-02-20T04:39:52Z","closed_at":"2026-02-20T04:39:52Z","close_reason":"Closed"}
{"id":"repomap-core-4f0.17","title":"Beads upgrade to v0.50+ (Dolt backend migration)","description":"Migrate beads from SQLite backend to Dolt backend. v0.50+ switches default storage; v0.51 removes SQLite entirely. Requires Dolt to be installed first (dep on 4f0.16). See docs/research/beads-dolt-and-multi-repo.md.","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-19T00:13:22Z","created_by":"galeavenworth-personal","updated_at":"2026-02-20T05:24:33Z","closed_at":"2026-02-20T05:24:33Z","close_reason":"Resolved: built bd v0.52.0 from source with CGO_ENABLED=1 to work around upstream bug #1849/#1856. Dolt server mode operational (76 issues imported). Install script and SKILL.md updated."}
{"id":"repomap-core-4f0.18","title":"Delegation proof expansion — child_relationships table + punch-based verification","description":"Delegation proof expansion (parent-child + punch verification). v3.2: GET /session/:id/children provides first-class parent-child correlation from kilo serve — eliminates timing heuristic.","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-19T00:13:31Z","created_by":"galeavenworth-personal","updated_at":"2026-02-21T00:39:48Z","closed_at":"2026-02-21T00:39:48Z","close_reason":"Closed"}
{"id":"repomap-core-4f0.19","title":"Composable thinking system — thinker modes, contracts, plans, handoff format","description":"Retroactive bead for ad-hoc thinking system overhaul.\n\n## What was built\n- 5 thinker mode definitions (abstract, adversarial, systems, concrete, epistemic)\n- 5 thinking-style contracts under .kilocode/contracts/thinking/\n- 1 universal thinking handoff format (thinking_handoff.md)\n- 4 thinking plan templates (design-subsystem, debug-incident, evaluate-dependency, strategic-decision)\n- Rewritten general-workflow.md (sequential thinking protocol)\n- Updated capabilities.md registry\n- Enhanced sequential-thinking-default SKILL.md\n\n## Scope\n.kilocode/contracts/thinking/, .kilocode/rules/general-workflow.md, .kilocode/rules/memory-bank/capabilities.md, .kilocode/skills/sequential-thinking-default/SKILL.md, .kilocodemodes\n\n## Acceptance Criteria\n- All 5 thinker modes parse in .kilocodemodes\n- All contracts loadable and referenced correctly\n- Thinking plans reference correct thinker mode slugs\n- One live thinker spawn succeeds end-to-end","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-19T01:21:39Z","created_by":"galeavenworth-personal","updated_at":"2026-02-19T12:33:04Z","closed_at":"2026-02-19T12:33:04Z","close_reason":"Closed"}
{"id":"repomap-core-4f0.2","title":"Workflow-specific gate definitions for plant-manager","description":"Define quality gates specific to workflow system changes (as opposed to src/ code gates).\n\n## Gates to Define\n\n1. **Mode validation** — .kilocodemodes parses as valid YAML, all mode slugs are unique, required fields present\n2. **Skill loading** — All SKILL.md files referenced in skills/ are syntactically valid, location paths resolve\n3. **Contract parsing** — All contract .md files in .kilocode/contracts/ parse correctly\n4. **Workflow coherence** — Mode definitions reference valid tool groups, file regex patterns compile\n\n## Implementation\n\n- Script or Python tool under .kilocode/tools/ (e.g., workflow_gate.py or workflow_gate.sh)\n- Can be invoked by plant-manager as part of its gate phase\n- Should produce structured pass/fail output parseable by orchestrators\n\n## Acceptance Criteria\n\n- Gate script exists and is executable\n- Covers mode validation, skill loading, contract parsing\n- Pass/fail output is deterministic and parseable\n- Integrates with bounded_gate.py runner (or equivalent for workflow gates)\n\n## References\n\n- Analysis: docs/research/orchestrator-composability-analysis-2026-02-15.md","status":"closed","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-16T00:07:28Z","created_by":"galeavenworth-personal","updated_at":"2026-02-18T00:28:22Z","closed_at":"2026-02-18T00:28:22Z","close_reason":"DONE: workflow_gate.py exists at .kilocode/tools/workflow_gate.py, validates modes/skills/contracts. Bounded gate runner at .kilocode/tools/bounded_gate.py. See roadmap Phase 1."}
{"id":"repomap-core-4f0.3","title":"Composability handoff contracts — plant-manager ↔ tactical orchestrators","description":"Define the handoff packet schemas and return format conventions for plant-manager delegating to tactical orchestrators.\n\n## Deliverables\n\n### 1. Handoff Packet Schema (Plant Manager → Tactical Orchestrator)\n\nThe message parameter passed to new_task when plant-manager spawns a tactical orchestrator. Must include:\n- task_id (bead reference)\n- scope description (what to do)\n- file pointers (what to touch)\n- success criteria (how to verify)\n- constraints (what NOT to do)\n- return format requirements (how to report back)\n\n### 2. Return Format Convention (Tactical Orchestrator → Plant Manager)\n\nThe attempt_completion result format. Options:\n- Markdown with known headers (## Status, ## Changes Made, ## Evidence, ## Issues Found)\n- Fenced JSON block with structured fields\n- Hybrid: markdown narrative + fenced JSON summary\n\n### 3. Error/Failure Propagation\n\nHow tactical orchestrators report failures back to plant-manager:\n- Gate failures (which gate, what error, was fitter attempted?)\n- Scope violations (task was larger than estimated)\n- Blocked dependencies (needs input plant-manager didn't provide)\n\n## Acceptance Criteria\n\n- Handoff packet schema documented with example\n- Return format convention documented with parsing guidance\n- Error propagation patterns documented\n- At least one end-to-end composability test (plant-manager → process-orchestrator → specialist)\n\n## References\n\n- Experiment: docs/research/nested-new-task-experiment-2026-02-15.md (return value findings)\n- Related: repomap-core-3wo (composability patterns research)","status":"closed","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-16T00:07:42Z","created_by":"galeavenworth-personal","updated_at":"2026-02-18T00:28:28Z","closed_at":"2026-02-18T00:28:28Z","close_reason":"DONE: Handoff contracts exist under .kilocode/contracts/ (line_fault, restoration, handoff, error_propagation, return_format). See roadmap Phase 1."}
{"id":"repomap-core-4f0.4","title":"Factory-inspector integration as spawnable subtask","description":"Integrate factory-inspector mode as a subtask spawnable by plant-manager for health assessment.\n\n## Scope\n\nDefine and test the pattern where plant-manager spawns factory-inspector via new_task to get a structured health report before making strategic decisions.\n\n## Deliverables\n\n1. Message template for plant-manager → factory-inspector delegation\n2. Return format for inspector health reports (parseable by plant-manager)\n3. Integration test: plant-manager spawns inspector, receives report, acts on it\n\n## Dependencies\n\n- repomap-core-4f0.1 (Plant Manager mode definition)\n- repomap-core-9o8 (Factory Inspector mode — can be minimal/stubbed)\n\n## Acceptance Criteria\n\n- Plant-manager can spawn factory-inspector subtask\n- Inspector returns structured health report\n- Plant-manager can parse and act on the report\n\n## References\n\n- Analysis: docs/research/orchestrator-composability-analysis-2026-02-15.md","status":"closed","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-16T00:07:51Z","created_by":"galeavenworth-personal","updated_at":"2026-02-18T00:28:08Z","closed_at":"2026-02-18T00:28:08Z","close_reason":"CUT by roadmap v2 pivot: No Factory Inspector mode to integrate. Plant Manager reads session data directly. See plans/roadmap-plant-infrastructure.md"}
{"id":"repomap-core-4f0.5","title":"Fitter dispatch patterns from plant-manager context","description":"UPDATED 2026-02-23: Informed by Experiment A/B data and governor architecture decision.\n\nFitter dispatch via command dialect — now the LINE FITTER specifically.\n\n## Key Insight (from Experiment A/B)\nThe runaway session (playful-mountain) was NOT a code issue — it was a LINE issue. The agent's execution path went off-track, not the code it was writing. The fitter's job is to resolve line issues, not code issues.\n\n## Updated Scope\n1. Governor detects loop (via punch card: step count \u003e threshold, repeated bash patterns, cost \u003e budget)\n2. Governor stops the session\n3. Governor inspects session state (what was it trying to do? what kept failing?)\n4. Governor dispatches a LINE FITTER with a bounded goal:\n   - Fresh session (≤100k tokens, cheap zone)\n   - Laser-focused prompt: 'The reconnection test is failing because X. Fix the test mock to handle Y. Do not touch the implementation. 3 files max. Commit and exit.'\n5. Governor resumes or re-dispatches the original bounded task\n\n## Depends On\n- repomap-core-7xo (governor epic — detection + kill + dispatch)\n- repomap-core-hlr (monorepo migration — fitter needs repomap artifacts for diagnosis)\n- commands.toml (routing: 'dispatch line-fitter' as routable command)\n\n## Acceptance Criteria\n- Fitter dispatch is a routable command\n- Fitter receives a bounded, diagnosed prompt (not the original full task)\n- Fitter session stays under 100k tokens\n- Restoration verified via punch card (not contract chain)\n- End-to-end: detect loop → diagnose → dispatch fitter → verify fix → resume\n\n## References\n- oc-daemon/docs/analysis/experiment-ab-comparison.md Section 8 (line vs code distinction)\n- plans/roadmap-plant-infrastructure.md Phase 3","status":"open","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-16T00:08:03Z","created_by":"galeavenworth-personal","updated_at":"2026-02-23T14:54:20Z"}
{"id":"repomap-core-4f0.6","title":"Ground routing matrix in actual infrastructure","description":"Inventory actual skills, tools, MCP tool names, contracts. Rebuild routing matrix TOML from reality. See plans/roadmap-plant-infrastructure.md Phase 2 item 1.","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-18T00:30:10Z","created_by":"galeavenworth-personal","updated_at":"2026-02-18T01:18:49Z","closed_at":"2026-02-18T01:18:49Z","close_reason":"Closed"}
{"id":"repomap-core-4f0.7","title":"Build commands.toml configuration (routing matrix)","description":"The routing matrix: verb+noun -\u003e skill binding + tool template. Maps all quality gate + beads operations to actual skills/tools. See plans/roadmap-plant-infrastructure.md Phase 2 item 2. Depends on: routing matrix inventory (4f0.6).","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-18T00:30:19Z","created_by":"galeavenworth-personal","updated_at":"2026-02-20T05:40:12Z","closed_at":"2026-02-20T05:40:12Z","close_reason":"Closed"}
{"id":"repomap-core-4f0.8","title":"Compressed workflow proof — command dialect token savings","description":"Compress quality gates to 6-line command dialect. Measure token savings vs beads_land_plane.sh. See plans/roadmap-plant-infrastructure.md Phase 2 item 3. Depends on: commands.toml (4f0.7).","status":"closed","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-18T00:30:26Z","created_by":"galeavenworth-personal","updated_at":"2026-02-20T06:12:49Z","closed_at":"2026-02-20T06:12:49Z","close_reason":"Closed"}
{"id":"repomap-core-4f0.9","title":"Parent-child task correlation in session monitor","description":"Extend kilo_session_monitor.py to link newTask spawns to child task directories by content/timing. New 'children' command shows subtask tree with cost rollup. See plans/roadmap-plant-infrastructure.md Phase 2 item 4.","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-18T00:30:33Z","created_by":"galeavenworth-personal","updated_at":"2026-02-18T03:56:17Z","closed_at":"2026-02-18T03:56:17Z","close_reason":"Closed"}
{"id":"repomap-core-4g0","title":"Research: Custom mode new_task capabilities","description":"CRITICAL GATE — blocks entire specialized orchestrator plan.\n\nInvestigate whether Kilo Code custom modes can access the new_task tool for spawning subtasks. This combines research areas §5a and §5b from the plan.\n\n## Questions to Answer\n\n1. Does Kilo Code's tool group system allow granting new_task to custom modes?\n2. Is new_task in a specific tool group (orchestrator?) or universally available?\n3. When a custom mode spawns a subtask via new_task, does the subtask get the same context isolation (summary-only returns) as the built-in Orchestrator?\n4. Does full context leak back to the parent (defeating token savings)?\n\n## Research Approach\n\n- Read Kilo Code source/docs for tool group definitions\n- Check new_task tool availability in custom mode configurations\n- Measure token usage in parent context after subtask completion\n\n## References\n\n- Kilo Code Custom Modes docs: https://kilo.ai/docs/agent-behavior/custom-modes\n- Kilo Code new_task tool docs: https://kilo.ai/docs/features/tools/new-task\n- Plan: plans/specialized-orchestrator-modes.md §5a, §5b\n\n## Acceptance Criteria\n\n- Document whether new_task is available to custom modes (yes/no)\n- Document context isolation behavior for custom-mode-spawned subtasks\n- If NO: document what failed and pivot plan to Approach B (enhanced generic Orchestrator)","spec_id":"plans/specialized-orchestrator-modes.md","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-14T19:42:15Z","created_by":"galeavenworth-personal","updated_at":"2026-02-15T17:09:52Z","closed_at":"2026-02-15T17:09:52Z","close_reason":"Closed"}
{"id":"repomap-core-4r3","title":"Retrofit session lifecycle workflows with commands.toml discipline + punch card exit gates","description":"Replace dated prose instructions with commands.toml verb+noun references and add punch card checkpoint as mandatory exit gate in session lifecycle workflows: load-game.md, save-game.md, beads-sync.md. Also update commands.toml sync_remote/sync_push entries to reflect that bd sync is now a no-op (replaced by bd export/bd import).","acceptance_criteria":"All 3 workflow files reference commands.toml routes. Each has a punch card exit gate. commands.toml sync entries updated to reflect current bd export/import model.","status":"closed","priority":0,"issue_type":"chore","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-21T15:25:56Z","created_by":"galeavenworth-personal","updated_at":"2026-02-21T17:34:41Z","closed_at":"2026-02-21T17:34:41Z","close_reason":"Closed","labels":["commands-toml","plant","workflow-discipline"]}
{"id":"repomap-core-7xo","title":"Governor: session loop detection + kill switch + line fitter dispatch","description":"Implement the governor — the enforcement mechanism that detects runaway sessions and dispatches line fitters.\n\n## Origin\nExperiment A/B (2026-02-23) proved that one runaway session (playful-mountain, 267 steps, $5.94) consumed 67% of total decomposed experiment cost and produced zero committed work. The runaway was NOT a code issue — it was a LINE issue (execution path went off-track, not the code being written).\n\n## The Governor's Job\n1. **Detect** — Monitor punch card in real-time for loop signatures:\n   - Step count exceeding threshold\n   - Cost exceeding budget\n   - Repeated tool patterns (e.g. bash→edit→bash→edit cycle)\n   - Cache read plateau (context window full, no new information)\n2. **Stop** — Kill the runaway session via SDK\n3. **Diagnose** — Inspect session state to classify the failure:\n   - What was it trying to do?\n   - What kept failing?\n   - What's the blast radius? (requires repomap artifacts)\n4. **Dispatch** — Send a specialized line fitter agent with a bounded goal:\n   - Fresh session (cheap tokens, ≤100k)\n   - Laser-focused prompt: 'Fix X because Y. Do not touch Z. Commit and exit.'\n5. **Resume** — Re-dispatch the original bounded task or mark as needs-human\n\n## Key Data Points (from experiments)\n- First 100k tokens: $0.29-0.42 (cheap zone)\n- Cost balloons 4.2x from first to fourth 100k in a single session\n- Decomposed (bounded): $0.42/100k tokens vs monolithic $0.72/100k = 42% savings\n- Tool adherence is invariant (44 edits in both experiments) — cornerstone #1\n- The governor needs repomap artifacts (call graph, change slices, blast radius) for intelligent diagnosis — this is why monorepo migration is required\n\n## Depends on\n- repomap-core-hlr (monorepo migration — governor needs access to repomap artifacts)\n- Punch card system (already recording punches via daemon)\n\n## Children (to be created)\n- Loop detection heuristics (step count, cost, tool pattern matching)\n- Session kill mechanism (SDK session.abort or equivalent)\n- Failure diagnosis engine (classify line issue type)\n- Line fitter dispatch (bounded prompt generation + fresh session)\n- Governor integration tests\n\n## References\n- oc-daemon/docs/analysis/experiment-ab-comparison.md (full cost data)\n- plans/roadmap-plant-infrastructure.md (punch-gated deployment loop)","status":"closed","priority":1,"issue_type":"epic","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-23T14:53:59Z","created_by":"galeavenworth-personal","updated_at":"2026-02-25T02:10:19Z","closed_at":"2026-02-25T02:10:19Z","close_reason":"Closed","labels":["governor factory-model"],"dependencies":[{"issue_id":"repomap-core-7xo","depends_on_id":"repomap-core-hlr","type":"blocks","created_at":"2026-02-23T09:54:05Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-7xo.1","title":"Loop detection heuristics — step count, cost, and tool pattern matching","description":"Implement real-time loop detection by monitoring the punch card stream for runaway signatures:\n\n- Step count exceeding configurable threshold (default: 100 steps)\n- Cost exceeding budget (default: $2.00 per session)\n- Repeated tool patterns (e.g. bash→edit→bash→edit cycle with no progress)\n- Cache read plateau (context window full, no new information being added)\n\nInput: punch stream from oc-daemon (already recording via SSE → classify → Dolt)\nOutput: LoopDetection event with classification (step_overflow | cost_overflow | tool_cycle | cache_plateau)\n\nReference: oc-daemon/docs/analysis/experiment-ab-comparison.md for thresholds derived from experiment data.","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-24T00:16:59Z","created_by":"galeavenworth-personal","updated_at":"2026-02-24T01:32:40Z","closed_at":"2026-02-24T01:32:40Z","close_reason":"Closed","labels":["factory-model","governor"],"dependencies":[{"issue_id":"repomap-core-7xo.1","depends_on_id":"repomap-core-7xo","type":"parent-child","created_at":"2026-02-23T19:16:58Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-7xo.2","title":"Session kill mechanism — abort runaway sessions via SDK","description":"Implement the ability to kill a runaway session detected by the loop detector.\n\n- Investigate kilo serve SDK for session abort/cancel API\n- If no native abort exists, implement via: close session + stop SSE stream + record kill punch\n- Must be idempotent (killing an already-dead session is a no-op)\n- Record a 'governor_kill' punch in Dolt with the kill reason and loop classification\n- Emit structured log for audit trail\n\nInput: sessionId + LoopDetection event from child 7xo.1\nOutput: KillConfirmation with final session stats (steps, cost, tokens)","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-24T00:17:11Z","created_by":"galeavenworth-personal","updated_at":"2026-02-24T01:32:40Z","closed_at":"2026-02-24T01:32:40Z","close_reason":"Closed","labels":["factory-model","governor"],"dependencies":[{"issue_id":"repomap-core-7xo.2","depends_on_id":"repomap-core-7xo","type":"parent-child","created_at":"2026-02-23T19:17:10Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-7xo.3","title":"Failure diagnosis engine — classify line issue type from session state","description":"After killing a runaway session, inspect its state to classify the failure for intelligent re-dispatch.\n\nDiagnosis categories:\n- stuck_on_approval: agent waiting for permission that never comes\n- infinite_retry: same tool call failing repeatedly with same error\n- scope_creep: agent wandered off-task (blast radius expanding)\n- context_exhaustion: cache full, agent re-reading same files\n- model_confusion: contradictory tool calls or hallucinated paths\n\nImplementation:\n- Read session message parts from kilo serve API\n- Analyze tool call patterns (last N tool calls, success/failure ratio)\n- Check punch card for cost trajectory (accelerating = bad)\n- Use repomap artifacts (call graph, change slices) for blast radius estimation if available\n- Output: DiagnosisReport with category, confidence, suggested_action, blast_radius\n\nInput: sessionId + KillConfirmation from child 7xo.2\nOutput: DiagnosisReport","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-24T00:17:22Z","created_by":"galeavenworth-personal","updated_at":"2026-02-24T01:51:11Z","closed_at":"2026-02-24T01:51:11Z","close_reason":"Closed","labels":["factory-model","governor"],"dependencies":[{"issue_id":"repomap-core-7xo.3","depends_on_id":"repomap-core-7xo","type":"parent-child","created_at":"2026-02-23T19:17:21Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-7xo.4","title":"Line fitter dispatch — bounded prompt generation + fresh session","description":"After diagnosis, dispatch a specialized line fitter agent with a bounded goal to fix what the runaway session failed to do.\n\nKey design:\n- Fresh session (cheap tokens, ≤100k context budget)\n- Laser-focused prompt: 'Fix X because Y. Do not touch Z. Commit and exit.'\n- Prompt generated from DiagnosisReport (category → prompt template)\n- Use Temporal workflow for dispatch (reuse agentTaskWorkflow with fitter agent mode)\n- Budget enforcement: set workflow timeout based on estimated cost from diagnosis\n\nPrompt templates by diagnosis category:\n- stuck_on_approval → re-dispatch with auto-approve permissions\n- infinite_retry → include error message + fix hint in prompt\n- scope_creep → narrow scope to only the files in blast radius\n- context_exhaustion → split task into smaller subtasks\n- model_confusion → switch to different model + simplified prompt\n\nInput: DiagnosisReport from child 7xo.3\nOutput: FitterResult with sessionId, cost, success/failure, files_changed\n\nReference: Experiment data shows decomposed bounded tasks cost $0.42/100k vs monolithic $0.72/100k (42% savings)","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-24T00:17:35Z","created_by":"galeavenworth-personal","updated_at":"2026-02-24T01:51:12Z","closed_at":"2026-02-24T01:51:12Z","close_reason":"Closed","labels":["factory-model","governor"],"dependencies":[{"issue_id":"repomap-core-7xo.4","depends_on_id":"repomap-core-7xo","type":"parent-child","created_at":"2026-02-23T19:17:34Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-7xo.5","title":"Governor integration tests — end-to-end detect→kill→diagnose→dispatch loop","description":"Integration tests for the full governor loop: detect → kill → diagnose → dispatch.\n\nTest scenarios:\n1. Simulated step overflow: inject 150+ punches, verify loop detection fires\n2. Simulated cost overflow: inject punches with escalating cost, verify budget kill\n3. Simulated tool cycle: inject repeating bash→edit→bash→edit pattern, verify cycle detection\n4. Kill confirmation: mock session abort, verify kill punch recorded in Dolt\n5. Diagnosis accuracy: feed known failure patterns, verify correct classification\n6. Fitter dispatch: verify bounded prompt generated from diagnosis, session created with correct agent mode\n7. End-to-end: full loop from punch injection to fitter completion\n\nInfrastructure:\n- Use vitest (already configured in daemon)\n- Mock kilo serve SDK responses for session operations\n- Use real Dolt for punch card verification (test database)\n- Temporal test environment for workflow assertions if feasible\n\nAcceptance criteria:\n- All 7 scenarios pass\n- No test takes longer than 30s\n- Tests are deterministic (no flaky timing dependencies)","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-24T00:17:47Z","created_by":"galeavenworth-personal","updated_at":"2026-02-25T02:10:14Z","closed_at":"2026-02-25T02:10:14Z","close_reason":"Closed","labels":["factory-model","governor"],"dependencies":[{"issue_id":"repomap-core-7xo.5","depends_on_id":"repomap-core-7xo","type":"parent-child","created_at":"2026-02-23T19:17:46Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-82w","title":"Research: Receipt infrastructure design — persistence format and thinking session introspection","description":"Design the receipt persistence format and validate thinking session introspection capabilities (§10a + §10b).\n\n## Questions\n\n### Receipt Persistence Format (§10a)\nShould receipts beyond gate_runs.jsonl be persisted in a structured format, or is filesystem glob matching sufficient?\n\nOptions:\n- A: Keep current approach (JSONL for gates, filesystem for sessions)\n- B: Unified receipt log (workflow_receipts.jsonl) recording all receipt types\n- C: Hybrid — gate runs stay in JSONL, add receipt_manifest_actual.json per bead_id\n\n### Thinking Session Introspection (§10b)\nCan receipt_audit.py meaningfully inspect thinking session JSON files without the sequential thinking MCP server?\n\nSession exports are JSON files. If the schema is documented, a script can parse them deterministically. If opaque, agent interpretation is required.\n\n## Research Approach\n\n1. Examine exported session file format (.kilocode/thinking/*.json) to determine schema\n2. Identify which quality metrics are extractable deterministically (stage count, thought count, branch budget)\n3. Evaluate persistence options against complexity and query needs\n4. Produce recommendation for Phase A implementation\n\n## Acceptance Criteria\n\n- Decision on receipt persistence format with rationale\n- Documented thinking session JSON schema (or assessment of opacity)\n- List of deterministically-extractable thinking quality metrics\n\n## References\n\n- Plan: plans/specialized-orchestrator-modes.md §10a, §10b\n- Receipt inventory table: §10 of plan","spec_id":"plans/specialized-orchestrator-modes.md","status":"closed","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-14T19:43:06Z","created_by":"galeavenworth-personal","updated_at":"2026-02-15T23:42:15Z","closed_at":"2026-02-15T23:42:15Z","close_reason":"Closed"}
{"id":"repomap-core-87i","title":"Phase 1 — Foundation Hardening","description":"Harden the existing repomap-core foundation before adding new features. Fix inconsistencies, expand test coverage, and align documentation.\n\nReferences:\n- Roadmap: plans/ROADMAP.md (Phase 1)\n- Architecture: plans/whitepaper_architecture_review.md\n\nDefinition of Done:\n- All 7 child tasks completed and closed\n- All quality gates pass (ruff format, ruff check, mypy, pytest)\n- No known inconsistencies in existing artifact generation\n","status":"closed","priority":1,"issue_type":"epic","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:32:51Z","created_by":"galeavenworth-personal","updated_at":"2026-02-14T05:20:07Z","closed_at":"2026-02-14T05:20:07Z","close_reason":"Closed"}
{"id":"repomap-core-87i.1","title":"Fix nested_gitignore consistency across all generators","description":"The nested_gitignore config option is supported in scanning (find_python_files) and passed through by DepsGenerator, but SymbolsGenerator and IntegrationsGenerator do not pass it. All generators must consistently honor this config.\n\nReferences:\n- Source: src/scan/files.py (find_python_files)\n- Source: src/artifacts/generators/symbols.py (SymbolsGenerator.generate)\n- Source: src/artifacts/generators/integrations.py (IntegrationsGenerator.generate)\n- Source: src/artifacts/generators/deps.py (DepsGenerator.generate — reference impl)\n- Config: src/rules/config.py (RepoMapConfig)\n\nDefinition of Done:\n- SymbolsGenerator.generate() passes nested_gitignore to find_python_files()\n- IntegrationsGenerator.generate() passes nested_gitignore to find_python_files()\n- Test verifies all generators produce identical file lists given same config\n- Quality gates pass\n","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:33:14Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T03:22:32Z","closed_at":"2026-02-12T03:22:32Z","close_reason":"Closed"}
{"id":"repomap-core-87i.2","title":"Module naming normalization — path-based to package-based","description":"Module names in artifacts use path-based naming (e.g., src.cli) instead of Python package names (e.g., repomap_core.cli). This causes ambiguity in dependency outputs and will block correct module identity in modules.jsonl. Normalize path_to_module() to produce package-resolvable names.\n\nReferences:\n- Source: src/utils.py (path_to_module)\n- Design: plans/deterministic_xref_callgraph_design.md (modules.jsonl section)\n- Artifacts: .repomap/deps.edgelist (shows src.* prefix issue)\n\nDefinition of Done:\n- path_to_module() produces package-resolvable module names\n- deps.edgelist uses normalized module names\n- symbols.jsonl qualified_name uses normalized module names\n- Existing tests updated for new naming\n- Quality gates pass\n","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:33:17Z","created_by":"galeavenworth-personal","updated_at":"2026-02-13T00:36:19Z","closed_at":"2026-02-13T00:36:19Z","close_reason":"Closed"}
{"id":"repomap-core-87i.3","title":"Test coverage expansion — artifact content tests","description":"No tests verify the actual content of generated artifacts. Add tests that generate artifacts from fixture repos and verify symbol records, dependency edges, and integration records contain expected content.\n\nReferences:\n- Generators: src/artifacts/generators/ (deps.py, symbols.py, integrations.py)\n- Orchestration: src/artifacts/write.py (generate_all_artifacts)\n\nDefinition of Done:\n- Test fixture repo exists under tests/fixtures/\n- Test verifies symbols.jsonl contains expected symbol records\n- Test verifies deps.edgelist contains expected edges\n- Test verifies deps_summary.json has correct statistics\n- Test verifies integrations_static.jsonl detects known integrations\n- Quality gates pass\n","status":"closed","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:33:21Z","created_by":"galeavenworth-personal","updated_at":"2026-02-14T02:25:14Z","closed_at":"2026-02-14T02:25:14Z","close_reason":"Closed"}
{"id":"repomap-core-87i.4","title":"Test coverage expansion — contract validation fixture tests","description":"Contract validation (validate_artifacts) is tested only for missing-dir error cases. Add fixture-based tests that validate well-formed and malformed artifacts to verify schema checking, JSONL line validation, and edgelist format validation.\n\nReferences:\n- Source: src/contract/validation.py (validate_artifacts, _validate_jsonl, _validate_deps_summary, _validate_edgelist)\n- Contract: src/contract/artifacts.py (TIER1_ARTIFACT_SPECS)\n\nDefinition of Done:\n- Test fixtures include valid Tier-1 artifacts that pass validation\n- Test fixtures include malformed artifacts that trigger specific validation errors\n- Tests cover JSONL schema validation, deps_summary schema, edgelist format\n- Quality gates pass\n","status":"closed","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:33:25Z","created_by":"galeavenworth-personal","updated_at":"2026-02-14T00:18:33Z","closed_at":"2026-02-14T00:18:33Z","close_reason":"Closed"}
{"id":"repomap-core-87i.5","title":"Test coverage expansion — layer classification tests","description":"Layer classification (classify_layer, is_violation) has no direct tests. Add tests that configure layer rules and verify correct classification and violation detection.\n\nReferences:\n- Source: src/rules/layers.py (classify_layer, is_violation)\n- Source: src/artifacts/summaries/builders.py (compute_layer_violations)\n- Config: src/rules/config.py (LayersConfig)\n\nDefinition of Done:\n- Tests configure layer rules matching repomap.toml structure\n- Tests verify classify_layer returns correct layer for known paths\n- Tests verify is_violation detects illegal cross-layer dependencies\n- Tests verify compute_layer_violations integrates correctly\n- Quality gates pass\n","status":"closed","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:33:28Z","created_by":"galeavenworth-personal","updated_at":"2026-02-14T02:44:46Z","closed_at":"2026-02-14T02:44:46Z","close_reason":"Closed"}
{"id":"repomap-core-87i.6","title":"README and documentation alignment","description":"README has minor drift: references 'repo_map/' as default dir while actual default is '.repomap'. Align all documentation with actual behavior.\n\nReferences:\n- README.md\n- Source: src/rules/config.py (RepoMapConfig.output_dir default)\n\nDefinition of Done:\n- README accurately describes default output directory\n- All CLI examples in README work as documented\n- No contradictions between README and actual behavior\n- Quality gates pass\n","status":"closed","priority":3,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:33:32Z","created_by":"galeavenworth-personal","updated_at":"2026-02-14T03:29:33Z","closed_at":"2026-02-14T03:29:33Z","close_reason":"Closed"}
{"id":"repomap-core-87i.7","title":"Unused config cleanup — semantic/analyzer toggles","description":"RepoMapConfig defines semantic (embedding provider/model) and analyzers (complexity/docstrings/security) settings with no implementation behind them. Either remove these or document them as reserved for future use.\n\nReferences:\n- Source: src/rules/config.py (SemanticConfig, AnalyzersConfig)\n- Roadmap: plans/ROADMAP.md (Phase 1)\n\nDefinition of Done:\n- Unused config sections either removed or clearly marked as reserved/future\n- No config options that silently do nothing\n- Quality gates pass\n","status":"closed","priority":3,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:33:39Z","created_by":"galeavenworth-personal","updated_at":"2026-02-14T04:34:13Z","closed_at":"2026-02-14T04:34:13Z","close_reason":"Closed"}
{"id":"repomap-core-9bg","title":"Retrofit specialized operation workflows with commands.toml discipline + punch card exit gates","description":"Replace dated prose instructions with commands.toml verb+noun references and add punch card checkpoint as mandatory exit gate in specialized operation workflows: fix-ci.md, respond-to-pr-review.md, refactor.md, friction-audit.md, fitter-line-health.md. These are standalone or specialist-invoked workflows that still use raw CLI/MCP prose instead of commands.toml routes.","acceptance_criteria":"All 5 workflow files reference commands.toml routes. Each has appropriate punch card exit gate where applicable. Format matches start-task.md/execute-task.md pattern.","status":"closed","priority":0,"issue_type":"chore","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-21T15:26:13Z","created_by":"galeavenworth-personal","updated_at":"2026-02-21T22:25:24Z","closed_at":"2026-02-21T22:25:24Z","close_reason":"Closed","labels":["commands-toml","plant","workflow-discipline"]}
{"id":"repomap-core-9hd","title":"Phase A: Define receipt manifests and build receipt_audit.py","description":"Build the deterministic receipt auditing layer (§10 Phase A).\n\n## Deliverables\n\n### 1. Receipt Manifest Definitions\n\nDefine JSON manifest schemas for each workflow type specifying what receipts MUST exist upon completion. Per §10:\n\n- gate_run receipts: gate_ids, expected status, source (gate_runs.jsonl), key fields\n- thinking_session receipts: file glob pattern, minimum stages, minimum thoughts\n- Per-workflow manifests for orchestrate-execute-task and orchestrate-start-task\n\n### 2. receipt_audit.py Script\n\nDeterministic script at .kilocode/tools/receipt_audit.py that:\n\n1. Takes --bead-id \u003cid\u003e and --workflow \u003ctype\u003e\n2. Loads the receipt manifest for that workflow type\n3. Checks each required receipt:\n   - Gate runs: queries gate_runs.jsonl for matching bead_id + status\n   - Thinking sessions: glob-matches .kilocode/thinking/ for expected files\n   - Optionally checks thinking session internals (stages present, thought count)\n4. Emits structured audit report (JSON):\n   - receipts_expected: count\n   - receipts_found: count\n   - receipts_missing: list\n   - receipts_degraded: list (found but low quality)\n   - overall_status: COMPLETE | PARTIAL | MISSING\n\nThis is a SCRIPT, not an agent. Deterministic output from deterministic inputs.\n\n## Acceptance Criteria\n\n- receipt_audit.py runs successfully against existing gate_runs.jsonl\n- Produces correct COMPLETE/PARTIAL/MISSING status\n- Handles missing files gracefully (no crashes)\n- JSON output is machine-parseable\n\n## References\n\n- Plan: plans/specialized-orchestrator-modes.md §10, Phase A\n- Receipt inventory table: §10\n- Depends on: repomap-core-82w (receipt infrastructure design research)","spec_id":"plans/specialized-orchestrator-modes.md","status":"closed","priority":2,"issue_type":"feature","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-14T19:44:34Z","created_by":"galeavenworth-personal","updated_at":"2026-02-18T00:27:57Z","closed_at":"2026-02-18T00:27:57Z","close_reason":"ABSORBED by roadmap v2 pivot: kilo_session_monitor.py IS the receipt query tool. receipt_audit.py no longer needed. See plans/roadmap-plant-infrastructure.md"}
{"id":"repomap-core-9o8","title":"Phase B: Create factory-inspector mode and analysis skill","description":"UPDATED 2026-02-15: Reconceived as dual-use mode under orchestrator composability.\n\nCreate the Factory Inspector mode for interpretive receipt analysis (§10 Phase B).\n\n## Dual-Use Design\n\nFactory Inspector operates in two contexts:\n\n### 1. Human-Invoked (Standalone)\nHuman directly invokes factory-inspector mode for ad-hoc analysis of workflow health, gate history, and thinking session quality. Produces a health report.\n\n### 2. Plant-Manager-Spawned (Subtask)\nPlant Manager spawns factory-inspector via new_task with a structured message containing:\n- Specific analysis scope (e.g., 'analyze gate_runs.jsonl for the last 7 days')\n- Output format requirements (parseable for orchestrator consumption)\n- Return via attempt_completion with structured recommendations\n\nBoth contexts use the same mode definition — the difference is in the message/context provided.\n\n## Deliverables\n\n### 1. Mode Definition in .kilocodemodes\n\nSlug: factory-inspector\nTool groups: read, command, mcp (sequential thinking for analysis)\nFile regex: \\.(md|txt|json|jsonl)$\n\nroleDefinition (~60 lines):\n- Factory observability analyst\n- Reads receipt audit reports, thinking session exports, gate run history\n- Detects patterns, surfaces anomalies, recommends workflow improvements\n- Does NOT modify code or workflow definitions — produces analysis reports only\n- When spawned as subtask, returns structured recommendations via attempt_completion\n\n### 2. Analysis Skill\n\nCreate .kilocode/skills/factory-inspection/SKILL.md defining:\n- When to invoke Factory Inspector (standalone and subtask contexts)\n- Input expectations (audit report JSON, gate_runs.jsonl, thinking sessions)\n- Output format (health report for standalone, structured recommendations for subtask)\n\n### Key Difference from Fitter\n\n- Fitter = REACTIVE (gate FAULT → diagnose → fix)\n- Factory Inspector = PROACTIVE (reads history → finds patterns → recommends)\n\n## Quality Metrics the Inspector Evaluates\n\n(unchanged from original)\n\n## Acceptance Criteria\n\n- Mode definition validates in .kilocodemodes\n- Skill document provides guidance for both invocation contexts\n- Inspector can read receipt_audit.py output and produce analysis\n- Return format is parseable by Plant Manager orchestrator\n\n## References\n\n- Plan: plans/specialized-orchestrator-modes.md §10, Phase B\n- Analysis: docs/research/orchestrator-composability-analysis-2026-02-15.md\n- Depends on: repomap-core-9hd (receipt_audit.py must exist)","spec_id":"plans/specialized-orchestrator-modes.md","status":"closed","priority":2,"issue_type":"feature","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-14T19:44:52Z","created_by":"galeavenworth-personal","updated_at":"2026-02-18T00:28:02Z","closed_at":"2026-02-18T00:28:02Z","close_reason":"CUT by roadmap v2 pivot: Plant Manager reads session data directly. No separate Factory Inspector mode needed. See plans/roadmap-plant-infrastructure.md"}
{"id":"repomap-core-9uq","title":"Phase 1: Create process-orchestrator mode definition","description":"Create the Process Orchestrator custom mode in .kilocodemodes (§3 Phase 1).\n\n## Deliverables\n\n1. New mode definition in .kilocodemodes for process-orchestrator slug\n2. Compact roleDefinition (~80 lines) embedding:\n   - Lifecycle phases: discover → explore → prepare → execute → gate → land\n   - Subtask routing table (which mode for which phase — see §4 routing table)\n   - Quality gate requirements (bounded_gate.py, audit proof)\n   - Fitter routing for line faults\n   - Handoff packet structure\n   - Bounded retry policy\n3. customInstructions (~30 lines) with:\n   - Beads integration protocol\n   - Session export/import pattern\n   - Runtime model reporting requirement\n\n## Routing Table (from §4)\n\n| Phase | Target Mode | Purpose |\n|---|---|---|\n| Discovery | architect | Fetch task details, strategic context |\n| Exploration | architect | Codebase context, map dependencies |\n| Preparation | architect | Sequential thinking, approach selection |\n| Implementation | code | Write code, make changes |\n| Testing | code | Add/update tests |\n| Quality Gates | code | Run bounded gates, fix failures |\n| Line Fault | fitter | Restore gate health |\n| Documentation | docs-specialist | Update docs if needed |\n\n## Size Constraints\n\n- roleDefinition: ≤100 lines (hard budget per risk register)\n- customInstructions: ≤50 lines (hard budget per risk register)\n\n## Acceptance Criteria\n\n- Process Orchestrator can complete a full start→execute→land cycle\n- Token usage for orchestration context is ≤30% of current workflow-doc-loading approach\n- Subtask isolation works identically to built-in Orchestrator\n- All quality gate, audit proof, and beads integration behaviors preserved\n\n## References\n\n- Plan: plans/specialized-orchestrator-modes.md §3 Phase 1, §4 routing tables\n- Depends on: repomap-core-r9v (Phase 0 spike must pass)","spec_id":"plans/specialized-orchestrator-modes.md","status":"closed","priority":1,"issue_type":"feature","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-14T19:43:35Z","created_by":"galeavenworth-personal","updated_at":"2026-02-15T18:44:47Z","closed_at":"2026-02-15T18:44:47Z","close_reason":"Closed"}
{"id":"repomap-core-bvj","title":"Stream E: Retest --auto in standalone mode (without --attach)","description":"Retest kilo run --auto in standalone mode (without --attach) to isolate whether follow-up question auto-response works independently of the --attach regression. This verifies whether F3 is a real bug or an artifact of F2. Manual verification task. Parent decision: repomap-core-w1a.","status":"open","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-22T13:29:54Z","created_by":"galeavenworth-personal","updated_at":"2026-02-22T13:29:54Z","labels":["sdk-pivot","verification"],"dependencies":[{"issue_id":"repomap-core-bvj","depends_on_id":"repomap-core-w1a","type":"discovered-from","created_at":"2026-02-22T08:29:53Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-c6j","title":"Research: Mode interaction patterns — switching vs spawning, Fitter integration","description":"Establish heuristics for when orchestrators should use switch_mode vs new_task, and verify Fitter integration contracts work with custom modes (§5e + §5f).\n\n## Questions\n\n### Mode Switching vs Subtask Spawning (§5e)\nWhen should a specialized orchestrator use switch_mode (hand off control) vs new_task (spawn isolated subtask)?\n\n- switch_mode preserves context but loses isolation\n- new_task provides isolation but loses shared state\n\nProposed heuristic:\n- Use new_task when subtask has a clear, bounded deliverable (implementation, test writing, gate running)\n- Use switch_mode when work requires continuous access to accumulated context (debugging complex issue)\n- Never switch_mode from one orchestrator to another orchestrator\n\n### Fitter Integration (§5f)\nHow does the Process Orchestrator's line-fault routing to Fitter change?\n\nCurrent model: Generic Orchestrator reads 'Line Health Routing' section of orchestrate-execute-task.md.\nProposed model: Process Orchestrator knows Fitter routing natively.\n\nVerify that contracted payloads (Line Fault → Restoration) work identically when parent is a custom mode vs built-in Orchestrator.\n\n## Acceptance Criteria\n\n- Documented heuristic for switch_mode vs new_task usage\n- Verified Fitter contracted payloads work from custom modes\n- Any edge cases or gotchas documented\n\n## References\n\n- Plan: plans/specialized-orchestrator-modes.md §5e, §5f\n- Current Fitter routing: .kilocode/workflows/orchestrate-execute-task.md line ~434","spec_id":"plans/specialized-orchestrator-modes.md","status":"closed","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-14T19:42:40Z","created_by":"galeavenworth-personal","updated_at":"2026-02-16T00:05:49Z","closed_at":"2026-02-16T00:05:49Z","close_reason":"Closed"}
{"id":"repomap-core-g6o","title":"Phase 3.5 — DSPy Optimization Layer","description":"DSPy (Declarative Self-improving Python) closes the feedback loop between execution data in Dolt and the prompts that drive agent behavior. Declares typed signatures, composes them into modules, and compiles optimal prompts against metrics derived from punch card pass/fail data. The seventh axis: Optimization. Research: docs/research/dspy-integration-analysis-2026-02-27.md","status":"open","priority":1,"issue_type":"epic","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-27T16:58:39Z","created_by":"galeavenworth-personal","updated_at":"2026-02-27T16:58:39Z"}
{"id":"repomap-core-g6o.1","title":"DSPy foundation — installation, LM config, basic integration","description":"Install dspy into the Python project. Configure it with existing model providers (Anthropic via Kilo Gateway, OpenAI via OAuth). Validate the basic signature→module→predict loop works end-to-end. Add dspy to pyproject.toml dependencies. Create a minimal smoke test.\n\nEXPANDED SCOPE (per 2026-02-27 review):\n- Prototype the Dolt-as-bus integration pattern: Python DSPy code reads/writes compiled prompts via Dolt MySQL protocol, TypeScript daemon reads from same tables. Prove the cross-language handoff works without a service layer.\n- Decide code placement: DSPy code lives in optimization/ top-level or daemon/optimization/, NOT in src/ (deterministic core).","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-27T16:58:46Z","created_by":"galeavenworth-personal","updated_at":"2026-02-28T02:55:27Z","closed_at":"2026-02-28T02:55:27Z","close_reason":"Closed","dependencies":[{"issue_id":"repomap-core-g6o.1","depends_on_id":"repomap-core-g6o","type":"parent-child","created_at":"2026-02-27T11:58:46Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-g6o.2","title":"Formalize fitter dispatch as DSPy Signatures","description":"Formalize the 5 hand-crafted prompt templates in daemon/src/governor/fitter-dispatch.ts as typed DSPy signatures. Create a DSPy module per diagnosis category (stuck_on_approval, infinite_retry, scope_creep, context_exhaustion, model_confusion).\n\nUPDATED (per 2026-02-27 review):\n- DECOUPLED from 4f0.5 — wrap the existing fitter-dispatch.ts templates directly as DSPy signatures. Once 4f0.5 lands, compiled prompts get routed through the new command dialect path. No blocking dependency.\n- Compiled prompt output goes to Dolt (Dolt-as-bus pattern from g6o.1).","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-27T16:58:54Z","created_by":"galeavenworth-personal","updated_at":"2026-02-28T03:06:21Z","closed_at":"2026-02-28T03:06:21Z","close_reason":"Closed","dependencies":[{"issue_id":"repomap-core-g6o.2","depends_on_id":"repomap-core-g6o","type":"parent-child","created_at":"2026-02-27T11:58:53Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-g6o.3","title":"Dolt training data extractor","description":"Extract (input, outcome) pairs from Dolt session data as DSPy Example objects.\n\nUPDATED (per 2026-02-27 review):\n- Depends on g6o.8 (expanded DoltWriter + session telemetry). Once g6o.8 lands, Dolt has full session data (conversations, tool calls, costs, modes, outcomes) — no need to parse Kilo's flat-file task store.\n- Query sessions, messages, tool_calls, punches, and checkpoints tables to build labeled training sets: successful sessions, failed sessions, kill→recovery pairs.\n- Session outcome labeling: sessions ending with gate_pass = success, sessions with high error density or governor kills = failure, sessions with child_spawn/child_complete = decomposition examples.\n- Output format compatible with dspy.Example.","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-27T16:59:00Z","created_by":"galeavenworth-personal","updated_at":"2026-02-28T03:15:03Z","closed_at":"2026-02-28T03:15:03Z","close_reason":"Closed","dependencies":[{"issue_id":"repomap-core-g6o.3","depends_on_id":"repomap-core-g6o","type":"parent-child","created_at":"2026-02-27T11:59:00Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-g6o.4","title":"DSPy metrics from punch card data","description":"Define quality metrics as Python functions over Dolt data for use with DSPy optimizers. Metrics include: punch card pass rate, cost efficiency (cost vs budget), task completion rate, fitter recovery success rate, tool adherence score. Each metric takes a dspy.Example and returns a score. Depends on: g6o.3 (training data extractor).","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-27T16:59:07Z","created_by":"galeavenworth-personal","updated_at":"2026-02-28T03:22:40Z","closed_at":"2026-02-28T03:22:40Z","close_reason":"Closed","dependencies":[{"issue_id":"repomap-core-g6o.4","depends_on_id":"repomap-core-g6o","type":"parent-child","created_at":"2026-02-27T11:59:07Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-g6o.5","title":"First compilation target — fitter prompts","description":"Compile fitter dispatch DSPy module with MIPROv2 or GEPA optimizer against recovery success rate metric. A/B test compiled prompts vs hand-written templates. Deploy winning prompts. Depends on: g6o.2 (fitter signatures) and g6o.4 (metrics).","status":"closed","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-27T16:59:14Z","created_by":"galeavenworth-personal","updated_at":"2026-02-28T03:31:46Z","closed_at":"2026-02-28T03:31:46Z","close_reason":"Closed","dependencies":[{"issue_id":"repomap-core-g6o.5","depends_on_id":"repomap-core-g6o","type":"parent-child","created_at":"2026-02-27T11:59:14Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-g6o.6","title":"DSPy assertions for task decomposition","description":"Add inner-loop constraints complementing outer-loop punch cards. Target: task decomposition module.\n\nUPDATED (per 2026-02-27 review):\n- DECISION: Use prompt-compiled assertions (option a) — assertion logic baked into prompt text via DSPy compilation. No Python sidecar service in v1.\n- Reasoning: Zero runtime dependency, consistent with Dolt-as-bus architecture, avoids introducing a new service. If prompt-compiled assertions prove too weak, upgrade to Python sidecar in a future iteration.\n- Enforce subtask count bounds, per-subtask cost targets, scope constraints — all compiled into the prompt template at optimization time.\n- Depends on: g6o.1 (DSPy foundation).","status":"closed","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-27T16:59:20Z","created_by":"galeavenworth-personal","updated_at":"2026-02-28T03:42:52Z","closed_at":"2026-02-28T03:42:52Z","close_reason":"Closed","dependencies":[{"issue_id":"repomap-core-g6o.6","depends_on_id":"repomap-core-g6o","type":"parent-child","created_at":"2026-02-27T11:59:20Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-g6o.7","title":"Diagnosis classifier as compiled DSPy module","description":"Replace or augment hand-coded heuristics in daemon/src/governor/diagnosis-engine.ts with a compiled DSPy classifier. Train on historical kill→diagnosis pairs from Dolt. The classifier takes tool patterns, last messages, and kill reason as input and outputs category + confidence + evidence. Depends on: g6o.4 (metrics).","status":"in_progress","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-27T16:59:27Z","created_by":"galeavenworth-personal","updated_at":"2026-02-28T03:23:45Z","dependencies":[{"issue_id":"repomap-core-g6o.7","depends_on_id":"repomap-core-g6o","type":"parent-child","created_at":"2026-02-27T11:59:27Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-g6o.8","title":"Expand DoltWriter to full session telemetry + fix child_rels + backfill Kilo store","description":"PREREQUISITE for DSPy optimization. Three deliverables:\n\n1. **Fix child_rels bug**: The code in daemon.ts:68 and catchup.ts:65 exists but child_rels has 0 rows despite 4 child_spawn/child_complete punches. Diagnose why writeChildRelation isn't firing and fix it.\n\n2. **Expand DoltWriter to capture full session telemetry**: Currently only writes punches and child_rels. Add new Dolt tables: sessions (metadata, mode, model, total cost, outcome, timestamps), messages (conversation history per session), tool_calls (tool name, args summary, result, duration, error, cost). The daemon should write this data as part of its normal SSE event processing and catch-up flow.\n\n3. **Backfill 1,089 historical tasks from Kilo Code task store**: One-time migration from ~/.config/Code/User/globalStorage/kilocode.kilo-code/tasks/ into the new Dolt tables. Each task has api_conversation_history.json, task_metadata.json, and ui_messages.json.\n\nThis is infrastructure that benefits everything (observability, debugging, governor), not just DSPy.","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-27T17:53:29Z","created_by":"galeavenworth-personal","updated_at":"2026-02-28T02:43:19Z","closed_at":"2026-02-28T02:43:19Z","close_reason":"Closed","dependencies":[{"issue_id":"repomap-core-g6o.8","depends_on_id":"repomap-core-g6o","type":"parent-child","created_at":"2026-02-27T12:53:28Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-hlr","title":"Monorepo migration: absorb oc-daemon into repomap-core","description":"Migrate oc-daemon (TypeScript sidecar daemon) into repomap-core as a subdirectory (e.g. daemon/ or packages/daemon/).\n\n## Context\nDecision made 2026-02-23 based on Experiment A/B cost analysis (docs/analysis/experiment-ab-comparison.md in oc-daemon). Dependencies between daemon and repomap-core are too strong:\n- Shared Dolt schema (punch-card-schema.sql is source of truth in repomap-core)\n- Governor needs real-time access to repomap artifacts (call graph, change slices, blast radius) for intelligent dispatch\n- Cross-repo coordination caused test conflicts in Experiment B\n- Dependencies will only get stronger as repomap product uses its own artifacts for dynamic punches\n\n## What moves\n- src/ (classifier, writer, lifecycle/daemon, lifecycle/catchup)\n- tests/\n- package.json, tsconfig.json, vitest.config.ts, eslint.config.js\n- .beads/ config (merge into repomap-core beads, re-prefix or absorb daemon-* issues)\n\n## What stays\n- oc-daemon repo archived (read-only), not deleted\n- docs/analysis/ and docs/prompts/ are gitignored artifacts, copy manually\n\n## Acceptance criteria\n- All daemon source lives in repomap-core under a clear subdirectory\n- npm run typecheck/lint/test/build all pass from the daemon subdirectory\n- Beads daemon-* issues are accessible from repomap-core\n- Roadmap updated to reflect monorepo\n- oc-daemon repo archived","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-23T14:53:37Z","created_by":"galeavenworth-personal","updated_at":"2026-02-24T00:03:32Z","closed_at":"2026-02-24T00:03:32Z","close_reason":"Closed","labels":["infra monorepo"]}
{"id":"repomap-core-i9b","title":"OpenCode plugin: cross-database beads status sync","description":"Build an OpenCode plugin that auto-syncs issue status changes across beads databases on the shared Dolt server.\n\n## Problem\nWhen an issue exists in multiple beads databases (e.g., daemon-001 in both beads_daemon and beads_repomap-core), status changes in one database don't propagate to the other. This requires manual SQL or bd close from both clones.\n\n## Solution\nAn OpenCode plugin (.opencode/plugins/) that:\n1. Hooks into bd close/update events (or post-commit)\n2. Reads the routes table to discover peer databases on the same Dolt server\n3. For issues with prefixes matching a route, propagates status changes to the canonical database\n4. Uses REPLACE INTO or UPDATE for idempotent propagation\n\n## Design Considerations\n- Plugin model (NOT hooks — hooks resolve bd via PATH and can find wrong version)\n- Fires on session.idle or post-commit events\n- Reads routes table to discover which databases have copies of an issue\n- Only syncs status/closed_at/close_reason fields (not full issue content)\n- Idempotent: safe to run multiple times\n\n## Acceptance Criteria\n- Plugin fires automatically on bd close/update\n- Status changes propagate across databases within same Dolt server\n- No duplicate-key errors (uses REPLACE INTO or conditional UPDATE)\n- Works with both repomap-core and oc-daemon clones\n- Does NOT use git hooks (uses OpenCode plugin model only)\n\n## References\n- Multi-repo architecture: docs/research/multi-repo-plant-architecture-2026-02-18.md\n- Beads multi-repo: docs/research/beads-dolt-and-multi-repo.md\n- Existing plugin: .opencode/plugins/beads-sync.ts\n- Routes table schema: prefix (varchar), path (varchar)\n- Discovered gap: bd repo sync has duplicate-key bug in v0.52.0","status":"closed","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-21T12:27:45Z","created_by":"galeavenworth-personal","updated_at":"2026-02-21T12:44:02Z","closed_at":"2026-02-21T12:44:02Z","close_reason":"Closed","dependencies":[{"issue_id":"repomap-core-i9b","depends_on_id":"repomap-core-4f0","type":"blocks","created_at":"2026-02-21T07:27:57Z","created_by":"galeavenworth-personal","metadata":"{}"}]}
{"id":"repomap-core-jxn","title":"Phase 5 — Polish \u0026 1.0","description":"Final polish for repomap-core 1.0 release. Full verification coverage, comprehensive documentation, dogfooding validation, performance benchmarking, and layer rule activation.\n\nReferences:\n- Roadmap: plans/ROADMAP.md (Phase 5)\n\nDefinition of Done:\n- All 6 child tasks completed and closed\n- repomap-core analyzes itself producing all artifacts correctly\n- Documentation complete and accurate\n- Performance acceptable on representative codebases\n- All quality gates pass\n","status":"open","priority":2,"issue_type":"epic","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:33:09Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:47:57Z"}
{"id":"repomap-core-jxn.1","title":"Full determinism verification covering all new artifacts","description":"Extend verify_determinism() to cover all artifacts including modules.jsonl, refs.jsonl, calls.jsonl, refs_summary.json, and any slice artifacts. Ensure byte-identical output across multiple runs.\n\nReferences:\n- Source: src/verify/verify.py (verify_determinism)\n- Tests: tests/test_verify_determinism.py\n\nDefinition of Done:\n- verify_determinism() checks all generated artifacts (not just Tier-1)\n- Tests verify byte-identical output for all artifact types\n- Any non-determinism sources identified and fixed\n- Quality gates pass\n","status":"open","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:35:02Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:48:03Z"}
{"id":"repomap-core-jxn.2","title":"Complete README + API reference documentation","description":"Rewrite README to cover all features including new artifacts, query API, and change slices. Add API reference documentation for the public contract surface.\n\nReferences:\n- README.md\n- Source: src/contract/ (public API surface)\n\nDefinition of Done:\n- README covers: installation, usage, all CLI subcommands, all artifacts\n- API reference for contract models, query API, validation API\n- Examples for common agent workflows\n- No inaccuracies or drift from actual behavior\n- Quality gates pass\n","status":"open","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:35:06Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:48:09Z"}
{"id":"repomap-core-jxn.3","title":"Artifact format reference documentation","description":"Create comprehensive documentation of every artifact format (.repomap/ file), including schema, field descriptions, and usage examples.\n\nReferences:\n- All artifact models in src/artifacts/models/\n- Contract specs in src/contract/artifacts.py\n- Design: plans/deterministic_xref_callgraph_design.md (schema drafts)\n\nDefinition of Done:\n- Documentation covers every artifact: symbols.jsonl, deps.edgelist, deps_summary.json, integrations_static.jsonl, modules.jsonl, refs.jsonl, calls.jsonl, refs_summary.json\n- Each artifact: schema version, field descriptions, example records, sort order\n- Published as plans/artifact_format_reference.md or similar\n- Quality gates pass\n","status":"open","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:35:12Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:48:14Z"}
{"id":"repomap-core-jxn.4","title":"Dogfooding — repomap-core analyzes itself with all artifacts","description":"Run repomap-core against its own codebase and verify all artifacts are correct and useful. Validate symbols, deps, call graph, and refs for the repomap-core source tree.\n\nReferences:\n- Existing: .repomap/ directory (current self-analysis)\n- Source: src/artifacts/write.py (generate_all_artifacts)\n\nDefinition of Done:\n- repomap generate . produces all artifacts including new ones\n- Artifacts are correct for the repomap-core codebase\n- No crashes, no missing data, no incorrect resolutions\n- Self-analysis used to validate graph completeness\n- Quality gates pass\n","status":"open","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:35:20Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:48:19Z"}
{"id":"repomap-core-jxn.5","title":"Performance benchmarking on larger codebases","description":"Benchmark repomap-core on representative larger Python codebases to identify performance bottlenecks and establish baseline metrics.\n\nReferences:\n- Roadmap: plans/ROADMAP.md (Phase 5)\n\nDefinition of Done:\n- Benchmarked on at least 2 codebases larger than repomap-core itself\n- Metrics collected: wall time, memory peak, artifact sizes\n- Performance bottlenecks identified\n- Acceptable performance for intended use cases (minutes, not hours)\n- Quality gates pass\n","status":"open","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:35:24Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:48:24Z"}
{"id":"repomap-core-jxn.6","title":"Layer rule activation — define and enforce layers","description":"Define and activate layer rules for the repomap-core project itself. Configure repomap.toml with layer definitions matching the actual architecture (foundation, verification, interface) and enforce them via compute_layer_violations().\n\nReferences:\n- Source: src/rules/layers.py (classify_layer, is_violation)\n- Source: src/rules/config.py (LayersConfig)\n- Config: repomap.toml\n- Architecture: .kilocode/rules/memory-bank/architecture.md\n\nDefinition of Done:\n- repomap.toml defines layers matching documented architecture\n- Layer rules enforce: foundation depends on nothing, verification on foundation only, interface on all\n- compute_layer_violations() detects real violations if present\n- deps_summary.json includes layer_violations data\n- Zero violations in current codebase (or violations fixed)\n- Quality gates pass\n","status":"open","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:35:28Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:48:30Z"}
{"id":"repomap-core-l5w","title":"Phase D: Post-workflow self-audit integration","description":"Add automatic self-audit as the final step of workflow execution (§10 Phase D).\n\n## Deliverables\n\n1. Add a 'self-audit' step at the end of /orchestrate-execute-task (or Process Orchestrator)\n2. Run receipt_audit.py automatically before landing the plane\n3. Flag PARTIAL/MISSING receipt status as warnings (not blockers, initially)\n\n## Design\n\nWhen a workflow reaches the 'land' phase:\n1. Extract current bead_id from session\n2. Run: receipt_audit.py --bead-id \u003cid\u003e --workflow orchestrate-execute-task\n3. If overall_status is COMPLETE: proceed with landing\n4. If PARTIAL or MISSING: emit warning in handoff packet, still land\n\nThis creates a feedback signal without blocking workflow completion. Over time, the warning threshold can be tightened.\n\n## Acceptance Criteria\n\n- Self-audit runs automatically at end of workflow execution\n- PARTIAL/MISSING results appear as warnings in completion output\n- Does not block or fail the workflow (advisory only, initially)\n- Works with both Process Orchestrator and generic Orchestrator workflows\n\n## References\n\n- Plan: plans/specialized-orchestrator-modes.md §10, Phase D\n- Depends on: repomap-core-9hd (receipt_audit.py), repomap-core-1jj (/factory-health-check workflow)","spec_id":"plans/specialized-orchestrator-modes.md","status":"closed","priority":3,"issue_type":"feature","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-14T19:45:16Z","created_by":"galeavenworth-personal","updated_at":"2026-02-18T00:28:36Z","closed_at":"2026-02-18T00:28:36Z","close_reason":"SIMPLIFIED by roadmap v2: Replaced by aud.1 (post-workflow session audit). Session-based audit, not separate infrastructure. See plans/roadmap-plant-infrastructure.md"}
{"id":"repomap-core-msm","title":"Research: Inspector → Fitter → Orchestrator feedback loop","description":"SIMPLIFIED 2026-02-15: Under orchestrator composability, the feedback loop becomes straightforward orchestrator coordination.\n\n## Original Problem\n\nWhen Factory Inspector recommends a Fit Profile change, there was no mechanism for that recommendation to propagate to Fitter defaults or Orchestrator gate invocations.\n\n## Simplified Design (Post-Composability)\n\nWith new_task composability proven, the Plant Manager orchestrator handles this directly:\n\n1. Plant Manager spawns Factory Inspector subtask → receives structured recommendations\n2. Plant Manager evaluates recommendations (strategic decision)\n3. Plant Manager spawns Fitter subtask with amendment payload → Fitter applies changes\n4. Plant Manager validates result via workflow-specific gates\n\nNo complex propagation mechanism, storage format, or approval workflow needed. The orchestrator IS the coordination mechanism.\n\n## Remaining Research Questions\n\n1. What format should Inspector recommendations use in attempt_completion return? (Parseable markdown vs fenced JSON)\n2. Should amendments be auto-applied or require human approval? (Start with human approval)\n3. How does Plant Manager track which amendments have been applied? (Gate run history)\n\n## Acceptance Criteria\n\n- Inspector recommendation return format specified\n- Plant Manager → Inspector → Fitter coordination pattern documented\n- Decision on auto-apply vs human-in-the-loop with rationale\n\n## References\n\n- Analysis: docs/research/orchestrator-composability-analysis-2026-02-15.md\n- Depends on: repomap-core-9o8 (Factory Inspector mode must be designed)","spec_id":"plans/specialized-orchestrator-modes.md","status":"closed","priority":3,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-14T19:45:28Z","created_by":"galeavenworth-personal","updated_at":"2026-02-18T00:28:15Z","closed_at":"2026-02-18T00:28:15Z","close_reason":"ABSORBED by roadmap v2 pivot: Feedback loop is now command→spawn→monitor session→verify. No Inspector→Fitter→Orchestrator chain needed. See plans/roadmap-plant-infrastructure.md"}
{"id":"repomap-core-nqk","title":"Retrofit task sub-workflows with commands.toml discipline + punch card exit gates","description":"Replace dated prose instructions with commands.toml verb+noun references and add punch card checkpoint as mandatory exit gate in task preparation sub-workflows: prep-task.md, codebase-exploration.md. These are sub-workflows called by start-task.md and execute-task.md (already retrofitted in repomap-core-4f0.15). Must align with parent workflow command reference format.","acceptance_criteria":"Both workflow files reference commands.toml routes. Format matches start-task.md/execute-task.md pattern (📌 verb noun → commands.key).","status":"closed","priority":0,"issue_type":"chore","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-21T15:26:04Z","created_by":"galeavenworth-personal","updated_at":"2026-02-21T19:48:54Z","closed_at":"2026-02-21T19:48:54Z","close_reason":"Closed","labels":["commands-toml","plant","workflow-discipline"]}
{"id":"repomap-core-qvs","title":"Phase 2: Create audit-orchestrator mode definition","description":"Create the Audit Orchestrator custom mode for adversarial reasoning workflows (§3 Phase 2).\n\n## Deliverables\n\n1. New mode definition in .kilocodemodes for audit-orchestrator slug\n2. Compact roleDefinition embedding adversarial orchestration logic:\n   - Spawn Identity Attack subtask → Product Skeptic mode\n   - Spawn Friction Audit subtask → Product Skeptic mode\n   - Spawn Surface Minimization subtask → Product Skeptic mode\n   - Spawn Leverage Hunt subtask → Architect mode\n   - Spawn Synthesis subtask → Architect mode\n   - Compile and present ranked recommendations\n\n## Routing Table (from §4)\n\n| Phase | Target Mode | Purpose |\n|---|---|---|\n| Identity Attack | product-skeptic | Adversarial identity critique |\n| Friction Audit | product-skeptic | Agent-as-user friction analysis |\n| Surface Minimization | product-skeptic | Removal candidate analysis |\n| Leverage Hunt | architect | Structural leverage identification |\n| Synthesis | architect | Integrate findings, rank recommendations |\n\n## Key Design Requirement\n\nThe mode must know that adversarial reasoning requires multiple attack vectors and that synthesis must weight findings by leverage, not just severity.\n\n## Size Constraints\n\n- roleDefinition: ≤100 lines\n- customInstructions: ≤50 lines\n\n## Acceptance Criteria\n\n- Audit Orchestrator produces identical quality pressure test reports as current workflow approach\n- Sequential thinking session management works across subtasks\n- Adversarial role assignment (Product Skeptic vs Architect) handled natively\n\n## References\n\n- Plan: plans/specialized-orchestrator-modes.md §2b, §3 Phase 2, §4\n- Depends on: repomap-core-r9v (Phase 0 spike must pass)","spec_id":"plans/specialized-orchestrator-modes.md","status":"closed","priority":2,"issue_type":"feature","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-14T19:43:59Z","created_by":"galeavenworth-personal","updated_at":"2026-02-15T21:49:38Z","closed_at":"2026-02-15T21:49:38Z","close_reason":"Closed"}
{"id":"repomap-core-qvz","title":"Phase 2: Annotate orchestrate-pressure-test.md as reference documentation","description":"Convert orchestrate-pressure-test.md from runtime template to reference documentation (§3 Phase 2 deliverable 3).\n\n## Changes Required\n\n1. Add header: 'This document is reference documentation. The Audit Orchestrator mode embeds this logic natively.'\n2. Mark sections now handled by the Audit Orchestrator roleDefinition\n3. Retain as reference material for understanding adversarial workflow logic\n\n## Files Affected\n\n- .kilocode/workflows/orchestrate-pressure-test.md\n\n## Acceptance Criteria\n\n- File has reference-doc header annotation\n- Audit Orchestrator mode does NOT load this file at runtime\n- Document remains accurate as reference\n\n## References\n\n- Plan: plans/specialized-orchestrator-modes.md §3 Phase 2\n- Depends on: repomap-core-qvs (audit-orchestrator mode must exist first)","spec_id":"plans/specialized-orchestrator-modes.md","status":"closed","priority":2,"issue_type":"chore","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-14T19:44:06Z","created_by":"galeavenworth-personal","updated_at":"2026-02-15T21:30:35Z","closed_at":"2026-02-15T21:30:35Z","close_reason":"Closed"}
{"id":"repomap-core-r9v","title":"Phase 0: Spike test — custom mode with new_task access","description":"GATE — must pass before Phase 1 or Phase 2 can begin.\n\nEmpirically validate that custom modes with new_task tool access work as documented (§3 Phase 0).\n\n## Spike Test Steps\n\n1. Create a minimal custom mode in .kilocodemodes with:\n   - Simple roleDefinition: 'You are a test orchestrator'\n   - Tool group that includes new_task access\n   - Simple customInstructions: 'Spawn a subtask to Architect mode'\n2. Invoke the custom mode\n3. Verify all of:\n   - Can it call new_task?\n   - Does the spawned subtask get proper context isolation?\n   - Does the parent receive only summaries (not full subtask context)?\n   - Does attempt_completion from the subtask return control to the parent?\n\n## If Spike FAILS\n\nThe entire plan pivots to Approach B (enhanced generic Orchestrator with compact workflow profiles). Document what failed and why.\n\n## If Spike SUCCEEDS\n\nProceed to Phase 1 (process-orchestrator) and Phase 2 (audit-orchestrator).\n\n## Deliverables\n\n- Minimal test mode definition (temporary, removed after validation)\n- Pass/fail report with evidence (screenshots, token measurements)\n- Go/no-go decision for Phase 1\n\n## References\n\n- Plan: plans/specialized-orchestrator-modes.md §3 Phase 0\n- Depends on: repomap-core-4g0 (custom mode new_task research)","notes":"Spike test performed manually by user after repomap-core-4g0 was completed by agent (pre-merge). User confirmed new_task capability works in custom modes via manual spike test. User confirmation supercedes contradicting conclusions made by agents during repomap-core-4g0 capability assessment.","spec_id":"plans/specialized-orchestrator-modes.md","status":"closed","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-14T19:43:19Z","created_by":"galeavenworth-personal","updated_at":"2026-02-15T18:26:23Z","closed_at":"2026-02-15T18:26:23Z","close_reason":"Closed"}
{"id":"repomap-core-w1a","title":"SDK Prompt API Pivot — Headless Agent Selection","description":"Pivot to SDK session.prompt() API for headless multi-agent orchestration, bypassing broken CLI --attach path (OpenCode #6489). Decision doc: docs/research/sdk-prompt-api-pivot-decision-2026-02-22.md. Five work streams: A (classifier fixes, oc-daemon), B (SDK prompt driver, oc-daemon), C (opencode.json config hygiene, repomap-core), D (upstream issue filing), E (--auto retest).","spec_id":"docs/research/sdk-prompt-api-pivot-decision-2026-02-22.md","status":"open","priority":1,"issue_type":"decision","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-22T13:28:46Z","created_by":"galeavenworth-personal","updated_at":"2026-02-22T13:28:46Z","external_ref":"opencode-6489","labels":["infra","multi-repo","sdk-pivot"]}
{"id":"repomap-core-wt5","title":"Research: Token budget analysis — specialized orchestrators and nesting cost profiles","description":"UPDATED 2026-02-15: Scope expanded to include nesting cost profiles from composability experiment.\n\n## Original Question\n\nWhat is the actual token cost of:\n- (A) Loading a 500-900 line workflow .md into generic Orchestrator context\n- (B) A specialized orchestrator with ~80-line roleDefinition + ~30-line customInstructions\n\n## Added Question (from composability experiment)\n\nWhat is the per-level cost of orchestrator nesting via new_task?\n\n### Preliminary Data (from nested-new-task-experiment-2026-02-15)\n- 3-level nesting test cost: ~$0.25 total\n- Estimated per-level system prompt overhead: ~$0.08\n- Each level receives full system prompt + rules + environment details from scratch\n\n## Research Approach (Updated)\n\n1. Measure actual token counts for current workflow .md files\n2. Estimate roleDefinition + customInstructions token counts\n3. Measure system prompt baseline cost per nesting level\n4. Model total cost for 2-level and 3-level nesting scenarios\n5. Calculate break-even: at what task frequency does nesting overhead pay for itself via context discipline?\n\n## Acceptance Criteria\n\n- Token count table comparing current vs proposed approach\n- Nesting cost profile table (1-level, 2-level, 3-level)\n- Decision: proceed if total overhead is manageable for typical task sizes\n\n## References\n\n- Plan: plans/specialized-orchestrator-modes.md §5c\n- Experiment: docs/research/nested-new-task-experiment-2026-02-15.md\n- Analysis: docs/research/orchestrator-composability-analysis-2026-02-15.md","spec_id":"plans/specialized-orchestrator-modes.md","status":"closed","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-14T19:42:27Z","created_by":"galeavenworth-personal","updated_at":"2026-02-16T00:30:45Z","closed_at":"2026-02-16T00:30:45Z","close_reason":"Closed"}
{"id":"repomap-core-ywk","title":"Phase 2 — XRef + Call-Graph Artifacts","description":"Implement the deterministic cross-reference index and resolved call graph — the major new feature that completes Layer 1 of the whitepaper architecture. Produces modules.jsonl, refs.jsonl, calls.jsonl, and refs_summary.json artifacts.\n\nReferences:\n- Design: plans/deterministic_xref_callgraph_design.md (authoritative)\n- Roadmap: plans/ROADMAP.md (Phase 2)\n- Whitepaper: plans/proposed_architecture_whitepaper.md (Layer 1)\n- Architecture review: plans/whitepaper_architecture_review.md (Layer 1 gap analysis)\n\nDefinition of Done:\n- All 9 child tasks completed and closed\n- New artifacts (modules.jsonl, refs.jsonl, calls.jsonl, refs_summary.json) generated deterministically\n- Contract surface extended with new artifact specs and validation\n- All quality gates pass\n- repomap-core can analyze itself producing all new artifacts\n","status":"open","priority":0,"issue_type":"epic","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:32:55Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:44:58Z"}
{"id":"repomap-core-ywk.1","title":"Add symbol_id and symbol_key to symbol records","description":"Extend SymbolRecord with two stable identifier fields:\n- symbol_id: precise location handle (sym:{path}::{qualified_name}@L{line}:C{col})\n- symbol_key: longitudinal identity (symkey:{path}::{qualified_name}::{kind})\n\nThese enable deterministic joining between symbols.jsonl and refs.jsonl/calls.jsonl.\n\nReferences:\n- Design: plans/deterministic_xref_callgraph_design.md (symbol_id and symbol_key sections)\n- Source: src/parse/treesitter_symbols.py (extract_symbols_treesitter)\n- Source: src/artifacts/generators/symbols.py (SymbolsGenerator.generate)\n- Model: src/artifacts/models/artifacts/symbols.py (SymbolRecord)\n- Contract: src/contract/models.py\n\nDefinition of Done:\n- SymbolRecord model includes symbol_id and symbol_key fields\n- symbols.jsonl emits both fields for every record\n- symbol_id is unique across all records (validated)\n- symbol_key is stable across runs when code doesn't change\n- Contract model updated\n- Quality gates pass\n","status":"closed","priority":0,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:33:43Z","created_by":"galeavenworth-personal","updated_at":"2026-02-15T01:27:07Z","closed_at":"2026-02-15T01:27:07Z","close_reason":"Closed"}
{"id":"repomap-core-ywk.2","title":"Emit modules.jsonl canonical module identity artifact","description":"Produce a new artifact .repomap/modules.jsonl that maps every Python file to its canonical module name. This is the single source of truth for module identity, consumed by refs.jsonl and calls.jsonl.\n\nRecords: { path, module, is_package, package_root }\n\nReferences:\n- Design: plans/deterministic_xref_callgraph_design.md (modules.jsonl section)\n- Source: src/utils.py (path_to_module — produces module names)\n- Source: src/scan/files.py (find_python_files — discovers files)\n\nDefinition of Done:\n- New ModulesGenerator produces .repomap/modules.jsonl\n- Every Python file in scan has exactly one record\n- Module names are package-resolvable (not path-based)\n- Artifact is deterministic (sorted, stable output)\n- Contract updated with MODULES_JSONL constant and spec\n- Quality gates pass\n","status":"closed","priority":0,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:33:46Z","created_by":"galeavenworth-personal","updated_at":"2026-02-15T01:27:07Z","closed_at":"2026-02-15T01:27:07Z","close_reason":"Closed"}
{"id":"repomap-core-ywk.3","title":"Tier 0: Raw call-site capture → calls_raw.jsonl","description":"Extract all call sites from Python source using Tree-sitter AST traversal. Emit calls_raw.jsonl with syntax-only information (no resolution). Each record includes src_span, callee_expr, enclosing_symbol_id, and evidence.strategy=syntax_only.\n\nThis is immediately valuable as \"structured grep\" for agents.\n\nReferences:\n- Design: plans/deterministic_xref_callgraph_design.md (Tier 0 section)\n- Source: src/parse/treesitter_symbols.py (Tree-sitter infrastructure to extend)\n\nDefinition of Done:\n- New call-site extractor using Tree-sitter\n- calls_raw.jsonl emitted with all call sites\n- Each record has stable ref_id, src_span, callee_expr, enclosing_symbol_id\n- callee_expr follows normalization rules from design doc\n- resolved_to is null for all Tier 0 records\n- Output is deterministic (sorted by canonical sort key)\n- Quality gates pass\n","status":"closed","priority":0,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:33:51Z","created_by":"galeavenworth-personal","updated_at":"2026-02-15T23:33:20Z","closed_at":"2026-02-15T23:33:20Z","close_reason":"Closed"}
{"id":"repomap-core-ywk.4","title":"Tier 1: Module-level name resolution → calls.jsonl + refs.jsonl","description":"Build per-module name tables from local defs, import bindings, and trivial aliases. Resolve call sites where the callee can be linked to a known symbol via imports. Emit calls.jsonl and refs.jsonl with resolution payloads.\n\nUses modules.jsonl to unify import names to internal file paths.\n\nReferences:\n- Design: plans/deterministic_xref_callgraph_design.md (Tier 1 section)\n- Source: src/parse/ast_imports.py (extract_imports — import parsing)\n- Source: src/utils.py (path_to_module — module naming)\n\nDefinition of Done:\n- Per-module name table built from defs + imports + aliases\n- calls.jsonl emitted with resolved_to for resolvable calls\n- refs.jsonl emitted with all reference kinds (call, read, write, annotation, etc.)\n- Resolution includes symbol_id, qualified_name, confidence, evidence.strategy\n- Internal vs external classification per design doc rules\n- Partial resolution (resolved_base_to + member) supported\n- Output deterministic, sorted by canonical sort key\n- Quality gates pass\n","status":"closed","priority":0,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:33:55Z","created_by":"galeavenworth-personal","updated_at":"2026-02-15T23:33:24Z","closed_at":"2026-02-15T23:33:24Z","close_reason":"Closed"}
{"id":"repomap-core-ywk.5","title":"Contract extension — new artifact specs + validation invariants","description":"Extend the contract surface to include all new artifacts from Phase 2. Add artifact specs, validation rules, and cross-artifact invariants.\n\nReferences:\n- Design: plans/deterministic_xref_callgraph_design.md (validation section)\n- Source: src/contract/artifacts.py (TIER1_ARTIFACT_SPECS)\n- Source: src/contract/validation.py (validate_artifacts)\n- Source: src/contract/models.py\n\nDefinition of Done:\n- MODULES_JSONL, REFS_JSONL, CALLS_JSONL, REFS_SUMMARY_JSON constants added\n- Artifact specs added to TIER1_ARTIFACT_SPECS (or new tier)\n- Validation: symbol_id uniqueness in symbols.jsonl\n- Validation: resolved_to.symbol_id exists in symbols.jsonl (when internal)\n- Validation: module fields match modules.jsonl mapping\n- Validation: resolved_to.dst_module matches modules.jsonl\n- JSONL schema validation for new artifacts\n- Quality gates pass\n","status":"open","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:33:58Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:44:59Z"}
{"id":"repomap-core-ywk.6","title":"Tier 2: Class-context resolution (self, cls, super)","description":"Resolve deterministic class-context call patterns:\n- ClassName.method() when ClassName resolves to known class\n- self.method() to enclosing class method (marked virtual/overridable)\n- cls.method() for classmethod contexts\n- super().method() to base class method when base is statically identifiable\n\nReferences:\n- Design: plans/deterministic_xref_callgraph_design.md (Tier 2 section)\n- Source: src/parse/treesitter_symbols.py (symbol catalog with class info)\n\nDefinition of Done:\n- self.method() resolved to enclosing class method symbol\n- cls.method() resolved similarly for classmethod contexts\n- super().method() resolved when single base class is statically known\n- ClassName.method() resolved when ClassName is in symbol catalog\n- All resolutions carry appropriate evidence.strategy and confidence\n- Virtual/overridable markers present where applicable\n- Quality gates pass\n","status":"open","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:34:03Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:44:59Z"}
{"id":"repomap-core-ywk.7","title":"Summary artifact — refs_summary.json","description":"Emit .repomap/refs_summary.json with aggregate statistics about cross-references and call resolution. Agent-friendly for quick gating and inspection.\n\nReferences:\n- Design: plans/deterministic_xref_callgraph_design.md (refs_summary.json)\n- Pattern: src/artifacts/summaries/builders.py (existing summary pattern)\n\nDefinition of Done:\n- refs_summary.json emitted with: total refs, total calls, resolution rates by tier\n- Counts broken down by ref_kind\n- Internal vs external resolution counts\n- Average confidence scores\n- Deterministic output\n- Quality gates pass\n","status":"open","priority":2,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:34:07Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:44:59Z"}
{"id":"repomap-core-ywk.8","title":"Deterministic ref_id + expr normalization","description":"Ensure every ref/call record has a deterministic ref_id following the design doc format: ref:{path}@L{line}:C{col}:{ref_kind}:{expr}. Apply expr normalization rules consistently across refs.jsonl and calls.jsonl.\n\nReferences:\n- Design: plans/deterministic_xref_callgraph_design.md (ref_id and expr normalization sections)\n\nDefinition of Done:\n- ref_id emitted on every record in refs.jsonl and calls.jsonl\n- ref_id format matches design doc specification\n- expr normalization rules applied: whitespace stripped, dotted names preserved, dynamic placeholders used\n- callee_expr in calls.jsonl excludes argument text\n- No file-system-dependent prefixes in expr\n- Quality gates pass\n","status":"open","priority":1,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:34:11Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:44:59Z"}
{"id":"repomap-core-ywk.9","title":"(Optional) Tier 3: Lightweight type inference","description":"Optional tier: resolve obj.method() when obj type can be inferred from local annotations, direct construction assignments (obj = TypeName(...)), or simple factory returns within the same file. Strictly bounded — no imports executed, no runtime evaluation.\n\nReferences:\n- Design: plans/deterministic_xref_callgraph_design.md (Tier 3 section)\n\nDefinition of Done:\n- Type inference from local annotations resolves method calls\n- Type inference from direct construction resolves method calls\n- evidence.strategy distinguishes type_from_annotation vs type_from_construction\n- No cross-file inference\n- No runtime evaluation\n- Quality gates pass\n","status":"open","priority":3,"issue_type":"task","owner":"galeavenworth+personal@gmail.com","created_at":"2026-02-12T02:34:16Z","created_by":"galeavenworth-personal","updated_at":"2026-02-12T02:45:00Z"}
